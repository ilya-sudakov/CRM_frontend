(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{2835:function(module,__webpack_exports__,__webpack_require__){"use strict";var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(15),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__),react_datepicker__WEBPACK_IMPORTED_MODULE_4__=(__webpack_require__(26),__webpack_require__(159),__webpack_require__(196),__webpack_require__(2863)),react_datepicker__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(react_datepicker__WEBPACK_IMPORTED_MODULE_4__),prop_types__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(2),prop_types__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_5__),date_fns_locale_ru__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(2864),date_fns_locale_ru__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(date_fns_locale_ru__WEBPACK_IMPORTED_MODULE_6__),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__=(__webpack_require__(2862),__webpack_require__(2842),__webpack_require__(1)),InputDate=function InputDate(props){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)("div",{className:"input_date",children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)("div",{className:"input_date__input",children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("div",{className:"input_date__input_name",children:props.inputName+(props.required?"*":"")}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("div",{className:!0===props.error?"input_date__input_field input_date__input_field--error":"input_date__input_field",children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(react_datepicker__WEBPACK_IMPORTED_MODULE_4___default.a,Object.assign({},props,{onChange:props.handleDateChange,disabledKeyboardNavigation:!0,dateFormat:props.showMonthYearPicker?"MM.yyyy":"dd.MM.yyyy",locale:date_fns_locale_ru__WEBPACK_IMPORTED_MODULE_6___default.a}))})]}),!0===props.error&&Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("div",{className:"input_date__error",onClick:props.setErrorsArr?function(){return props.setErrorsArr(Object.assign({},props.errorsArr,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()({},props.name,!1)))}:null,children:"Поле не заполнено!"})]})};InputDate.displayName="InputDate",InputDate.__docgenInfo={description:"",methods:[],displayName:"InputDate",props:{inputName:{type:{name:"string"},required:!1,description:""},required:{type:{name:"bool"},required:!1,description:""},error:{type:{name:"bool"},required:!1,description:""},type:{type:{name:"string"},required:!1,description:""},name:{type:{name:"string"},required:!1,description:""},handleDateChange:{type:{name:"func"},required:!1,description:""},selected:{type:{name:"instanceOf",value:"Date"},required:!1,description:""},readOnly:{type:{name:"bool"},required:!1,description:""},showMonthYearPicker:{type:{name:"bool"},required:!1,description:""},setErrorsArr:{type:{name:"func"},required:!1,description:""},errorsArr:{type:{name:"object"},required:!1,description:""}}},__webpack_exports__.a=InputDate,InputDate.propTypes={inputName:prop_types__WEBPACK_IMPORTED_MODULE_5___default.a.string,required:prop_types__WEBPACK_IMPORTED_MODULE_5___default.a.bool,error:prop_types__WEBPACK_IMPORTED_MODULE_5___default.a.bool,type:prop_types__WEBPACK_IMPORTED_MODULE_5___default.a.string,name:prop_types__WEBPACK_IMPORTED_MODULE_5___default.a.string,handleDateChange:prop_types__WEBPACK_IMPORTED_MODULE_5___default.a.func,selected:prop_types__WEBPACK_IMPORTED_MODULE_5___default.a.instanceOf(Date),readOnly:prop_types__WEBPACK_IMPORTED_MODULE_5___default.a.bool,showMonthYearPicker:prop_types__WEBPACK_IMPORTED_MODULE_5___default.a.bool,setErrorsArr:prop_types__WEBPACK_IMPORTED_MODULE_5___default.a.func,errorsArr:prop_types__WEBPACK_IMPORTED_MODULE_5___default.a.object},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/utils/Form/InputDate/InputDate.jsx"]={name:"InputDate",docgenInfo:InputDate.__docgenInfo,path:"src/utils/Form/InputDate/InputDate.jsx"})},2842:function(module,exports,__webpack_require__){var api=__webpack_require__(48),content=__webpack_require__(2843);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},2843:function(module,exports,__webpack_require__){(exports=__webpack_require__(49)(!1)).push([module.i,':root{--accent-color--light: #f8f1f1;--accent-color--contrast: #16c79a;--main-color: #4293b6;--main-color--dark: #19456b}.input_date{width:calc(100% - 20px);display:flex;flex-direction:column;margin-bottom:20px}.input_date .input_date__error{width:100%;box-sizing:border-box;margin-top:1px;font-size:0.75rem;border:1px solid #d48282;background-color:#fadada;color:#ad1c1c;border-radius:3px;padding:5px 10px;transition:0.2s ease-in-out;cursor:pointer}.input_date .input_date__input{display:flex;flex-direction:column;align-items:flex-start;justify-content:space-between;width:100%}.input_date .input_date__input .input_date__input_name{color:#666;flex:0 1 calc(20% - 10px);padding-right:10px;width:100%;margin-bottom:5px}.input_date .input_date__input .input_date__input_field{display:flex;justify-content:center;width:calc(90% - 20px);position:relative;width:100%}.input_date .input_date__input .input_date__input_field .react-datepicker-wrapper{width:100%}.input_date .input_date__input .input_date__input_field .react-datepicker-wrapper .react-datepicker{z-index:999}.input_date .input_date__input .input_date__input_field .react-datepicker-wrapper .react-datepicker .react-datepicker__day--selected{background-color:#4293b6 !important}.input_date .input_date__input .input_date__input_field .react-datepicker-popper{z-index:999}.input_date .input_date__input .input_date__input_field input[type="text"],.input_date .input_date__input .input_date__input_field input[type="password"]{border:1px solid #bbbbbb;width:100%;padding:5px 10px;border-radius:3px;box-sizing:border-box;transition:100ms ease-in-out;min-height:2rem}.input_date .input_date__input .input_date__input_field input[type="text"]:hover,.input_date .input_date__input .input_date__input_field input[type="password"]:hover{border-color:#888888}.input_date .input_date__input .input_date__input_field input[type="text"]:focus,.input_date .input_date__input .input_date__input_field input[type="password"]:focus{border:1px solid #4293b6}.input_date .input_date__input .input_date__input_field--error input[type="text"],.input_date .input_date__input .input_date__input_field--error input[type="password"]{border:1px solid #d48282 !important}.input_date .input_date__input .input_date__input_field:focus{border:1px solid #4293b6}@media (max-width: 768px){.input_date .input_date__input{flex-wrap:wrap;flex-direction:column;align-items:flex-start}.input_date .input_date__input .input_date__input_name{width:100%;margin-bottom:5px}.input_date .input_date__input .input_date__input_field{width:100%}.input_date .input_date__input .input_date__input_field input{padding:10px !important}}\n',""]),module.exports=exports},2848:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/chevron-down.d0a0493c.svg"},2893:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return saveExcelFile})),__webpack_require__.d(__webpack_exports__,"a",(function(){return exportClientsEmailsCSV}));var _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(36),_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(20),_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1__),xlsx__WEBPACK_IMPORTED_MODULE_35__=(__webpack_require__(130),__webpack_require__(79),__webpack_require__(2943),__webpack_require__(2894),__webpack_require__(2895),__webpack_require__(2896),__webpack_require__(2897),__webpack_require__(2898),__webpack_require__(2899),__webpack_require__(2900),__webpack_require__(2901),__webpack_require__(2902),__webpack_require__(2903),__webpack_require__(2904),__webpack_require__(2905),__webpack_require__(2906),__webpack_require__(2907),__webpack_require__(2908),__webpack_require__(2909),__webpack_require__(2910),__webpack_require__(2911),__webpack_require__(2912),__webpack_require__(2913),__webpack_require__(2914),__webpack_require__(2915),__webpack_require__(2916),__webpack_require__(2917),__webpack_require__(2918),__webpack_require__(149),__webpack_require__(50),__webpack_require__(159),__webpack_require__(160),__webpack_require__(198),__webpack_require__(2919)),xlsx__WEBPACK_IMPORTED_MODULE_35___default=__webpack_require__.n(xlsx__WEBPACK_IMPORTED_MODULE_35__),file_saver__WEBPACK_IMPORTED_MODULE_36__=__webpack_require__(2946),file_saver__WEBPACK_IMPORTED_MODULE_36___default=__webpack_require__.n(file_saver__WEBPACK_IMPORTED_MODULE_36__),_sorting_sorting_js__WEBPACK_IMPORTED_MODULE_37__=__webpack_require__(297),saveExcelFile=function(){var _ref=_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0___default()(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.mark((function _callee(workBook,fileName){var buffer;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,workBook.xlsx.writeBuffer();case 2:buffer=_context.sent,file_saver__WEBPACK_IMPORTED_MODULE_36___default.a.saveAs(new Blob([buffer]),"".concat(fileName,".xlsx"));case 4:case"end":return _context.stop()}}),_callee)})));return function saveExcelFile(_x,_x2){return _ref.apply(this,arguments)}}();function s2ab(s){for(var buf=new ArrayBuffer(s.length),view=new Uint8Array(buf),i=0;i!=s.length;++i)view[i]=255&s.charCodeAt(i);return buf}var clientColWidths=[{width:30},{width:20},{width:30},{width:40}],exportClientsEmailsCSV=function exportClientsEmailsCSV(clients){Promise.all(Object(_sorting_sorting_js__WEBPACK_IMPORTED_MODULE_37__.a)(clients,{fieldName:"name",direction:"asc"}).map((function(client){return function addClientContacts(dataWS,client,index){client.contacts.map((function(contactData){var clientRow=[[client.name,client.site,contactData.name,contactData.email]];dataWS=0===index?xlsx__WEBPACK_IMPORTED_MODULE_35___default.a.utils.aoa_to_sheet(clientRow):xlsx__WEBPACK_IMPORTED_MODULE_35___default.a.utils.sheet_add_aoa(dataWS,clientRow,{origin:"A"+index}),index++}))}(null,client,0)}))).then((function(){null["!cols"]=clientColWidths;var wb=xlsx__WEBPACK_IMPORTED_MODULE_35___default.a.utils.book_new();xlsx__WEBPACK_IMPORTED_MODULE_35___default.a.utils.book_append_sheet(wb,null,"Почты"),function saveEmailsCSV(wb,fileName){var wboutput=xlsx__WEBPACK_IMPORTED_MODULE_35___default.a.write(wb,{bookType:"xlsx",bookSST:!1,type:"binary"});file_saver__WEBPACK_IMPORTED_MODULE_36___default.a.saveAs(new Blob([s2ab(wboutput)],{type:""}),fileName)}(wb,"ЭлПочты_SendPulse.xlsx")}))}},2920:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return sortEmployees})),__webpack_require__.d(__webpack_exports__,"a",(function(){return getMonthDates}));__webpack_require__(464),__webpack_require__(196);var sortEmployees=function sortEmployees(employees){return employees.sort((function(a,b){return a.employee.lastName<b.employee.lastName?-1:a.employee.lastName>b.employee.lastName?1:0}))},getMonthDates=function getMonthDates(curDate){for(var date=new Date(curDate.getFullYear(),curDate.getMonth()+1,0).getDate()+1,dates=[],i=1;i<date;i++)dates.push(i);return dates}},2927:function(module,exports){},2937:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/download.9a4f4efd.svg"},2944:function(module,exports){},2945:function(module,exports){},2995:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return getReportTableExcel}));var _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(36),_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(18),_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__),_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(20),_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2__),exceljs__WEBPACK_IMPORTED_MODULE_14__=(__webpack_require__(35),__webpack_require__(2996),__webpack_require__(196),__webpack_require__(256),__webpack_require__(2837),__webpack_require__(50),__webpack_require__(130),__webpack_require__(79),__webpack_require__(160),__webpack_require__(149),__webpack_require__(198),__webpack_require__(2998)),exceljs__WEBPACK_IMPORTED_MODULE_14___default=__webpack_require__.n(exceljs__WEBPACK_IMPORTED_MODULE_14__),API_employees__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(227),API_WorkManaging_work_control__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(467),Utils_functions_jsx__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(61),Utils_dataObjects_js__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(2847),Utils_xlsxFunctions_js__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(2893),_functions_js__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(2920),getReportTableColumnXLSX=function getReportTableColumnXLSX(name){var width=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;return{key:name,width:width,style:{font:{size:12},alignment:{vertical:"middle"}}}},thinBorder={style:"thin",color:{argb:"00000000"}},reportTableDefaultColumnds=[getReportTableColumnXLSX("name",45)].concat(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_1___default()(Array(16).fill(getReportTableColumnXLSX(void 0))),[getReportTableColumnXLSX(void 0,10)]),defaultBorder={top:thinBorder,left:thinBorder,bottom:thinBorder,right:thinBorder},getDatesForReportTable=function getDatesForReportTable(curDate){for(var dates=[[""],[""]],lastDate=new Date(curDate.getFullYear(),curDate.getMonth()+1,0).getDate()+1,i=1;i<lastDate;i++)i<16?dates[0].push(i):dates[1].push(i);return dates},getDateTitle=function getDateTitle(workSheet,curDate){var type=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"first",dateTitleRow=workSheet.addRow(["".concat("first"===type?"1/2":"2/2"," ").concat(Utils_dataObjects_js__WEBPACK_IMPORTED_MODULE_18__.c[curDate.getMonth()],".").concat(curDate.getFullYear())]);workSheet.getCell(workSheet.rowCount,1).border=defaultBorder,workSheet.mergeCells(workSheet.rowCount,1,workSheet.rowCount,18),dateTitleRow.font={bold:!0,size:18},dateTitleRow.alignment={vertical:"middle",horizontal:"center"},dateTitleRow.height=50},fillBorderInBetween=function fillBorderInBetween(workSheet,i){i>=2&&i<=17&&(workSheet.getCell(workSheet.rowCount,i).border={right:{style:"hair",color:{argb:"00000000"}},bottom:thinBorder})},getDatesHeaderList=function getDatesHeaderList(workSheet,dates){var array=getRemainingDaysSpaces(dates);workSheet.addRow([].concat(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_1___default()(dates),_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_1___default()(array),["Сумма"]));for(var i=1;i<=18;i++)workSheet.getCell(workSheet.rowCount,i).border=defaultBorder,fillBorderInBetween(workSheet,i)},filterWorksList=function filterWorksList(employeesWorksList,workshop){return employeesWorksList.filter((function(employee){return employee.employee.workshop===workshop&&("Уволен"!==employee.employee.relevance||employee.days.reduce((function(prev,cur){return null!==cur.hours||null!==cur.day?prev+1:prev}),0)>0)}))},getWorkshopNameRow=function getWorkshopNameRow(workSheet,workshop){var titleRow=workSheet.addRow([workshop]);workSheet.getCell(workSheet.rowCount,1).border=defaultBorder,workSheet.mergeCells(workSheet.rowCount,1,workSheet.rowCount,18),titleRow.font={size:14,bold:!0},titleRow.alignment={vertical:"middle",horizontal:"center"},titleRow.height=30},getRemainingDaysSpaces=function getRemainingDaysSpaces(dates){if(dates.length>16)return[];var array=[""];return 15-(dates.length-1)>0&&(array=Array(15-(dates.length-2)).fill("")),array},getEmployeeWorkRow=function getEmployeeWorkRow(workSheet,item,index,dates){var employeeInfo=[[Object(Utils_functions_jsx__WEBPACK_IMPORTED_MODULE_17__.p)(item.employee)]],sum=0;dates.map((function(date){var check=null;if(item.days.map((function(workDay){workDay.day===date&&(check=workDay.hours,sum+=check)})),""!==date)return null===check?employeeInfo[0].push(""):employeeInfo[0].push(check)}));var array=getRemainingDaysSpaces(dates);return workSheet.addRow([].concat(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_1___default()(employeeInfo[0]),_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_1___default()(array),[sum])),getEmployeeWorkRowBorders(workSheet,index)},getEmployeeWorkRowBorders=function getEmployeeWorkRowBorders(workSheet,index){for(var i=1;i<=18;i++)workSheet.getCell(workSheet.rowCount,i).fill={type:"pattern",pattern:"solid",fgColor:{argb:index%2==0?"FFFEFF99":"FFFFFFFF"}};workSheet.getCell(workSheet.rowCount,1).border={right:thinBorder};for(var _i=2;_i<=17;_i++)workSheet.getCell(workSheet.rowCount,_i).border={right:{style:"hair",color:{argb:"00000000"}}};return workSheet.getCell(workSheet.rowCount,18).border=defaultBorder},createBorders=function createBorders(workSheet){for(var i=1;i<=18;i++)workSheet.getCell(workSheet.rowCount,i).border={bottom:thinBorder},fillBorderInBetween(workSheet,i);workSheet.getCell(workSheet.rowCount,1).border={right:thinBorder,bottom:thinBorder},workSheet.getCell(workSheet.rowCount,18).border={right:thinBorder,bottom:thinBorder,left:thinBorder}},getHalfMonthList=function getHalfMonthList(filteredWorkshops,employeesWorksList,workSheet,curDate){var type=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"first",dates=getDatesForReportTable(curDate),arrayIndex="first"===type?0:1;getDateTitle(workSheet,curDate,type),getDatesHeaderList(workSheet,dates[arrayIndex]),filteredWorkshops.map((function(workshop){var filteredWorksList=filterWorksList(employeesWorksList,workshop);return filteredWorksList.length>0&&getWorkshopNameRow(workSheet,workshop),Object(_functions_js__WEBPACK_IMPORTED_MODULE_20__.b)(filteredWorksList).map((function(item,index){return getEmployeeWorkRow(workSheet,item,index,dates[arrayIndex])}))})),createBorders(workSheet);var temp=workSheet.addRow([""]);temp.height=50},loadEmployeeWorkData=function(){var _ref=_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0___default()(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2___default.a.mark((function _callee(filteredWorkshops,curDate){var employeesList,employeesWorksList;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2___default.a.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return employeesList=[],employeesWorksList=[],_context.next=4,Promise.all(filteredWorkshops.map((function(workshop){return Object(API_employees__WEBPACK_IMPORTED_MODULE_15__.h)({workshop:workshop}).then((function(res){return res.json()})).then((function(employees){return employeesList.push.apply(employeesList,_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_1___default()(employees))}))}))).then((function(){return Promise.all(employeesList.map((function(item){return Object(API_WorkManaging_work_control__WEBPACK_IMPORTED_MODULE_16__.l)(item.id,curDate.getMonth()+1,curDate.getFullYear()).then((function(res){return res.json()})).then((function(res){return employeesWorksList.push(res)}))})))}));case 4:return _context.abrupt("return",{employeesWorksList:employeesWorksList});case 5:case"end":return _context.stop()}}),_callee)})));return function loadEmployeeWorkData(_x,_x2){return _ref.apply(this,arguments)}}();function getReportTableExcel(){return _getReportTableExcel.apply(this,arguments)}function _getReportTableExcel(){return(_getReportTableExcel=_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0___default()(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2___default.a.mark((function _callee2(){var curDate,filteredWorkshops,workBook,workSheet,_yield$loadEmployeeWo,employeesWorksList,defaultParams,_args2=arguments;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2___default.a.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return curDate=_args2.length>0&&void 0!==_args2[0]?_args2[0]:new Date,filteredWorkshops=_args2.length>1&&void 0!==_args2[1]?_args2[1]:[],workBook=new exceljs__WEBPACK_IMPORTED_MODULE_14___default.a.Workbook,(workSheet=workBook.addWorksheet(Utils_dataObjects_js__WEBPACK_IMPORTED_MODULE_18__.c[curDate.getMonth()])).columns=reportTableDefaultColumnds,_context2.next=7,loadEmployeeWorkData(filteredWorkshops,curDate);case 7:_yield$loadEmployeeWo=_context2.sent,employeesWorksList=_yield$loadEmployeeWo.employeesWorksList,getHalfMonthList.apply(void 0,(defaultParams=[filteredWorkshops,employeesWorksList,workSheet,curDate]).concat(["first"])),getHalfMonthList.apply(void 0,defaultParams.concat(["second"])),Object(Utils_xlsxFunctions_js__WEBPACK_IMPORTED_MODULE_19__.b)(workBook,"Табель-".concat(Utils_dataObjects_js__WEBPACK_IMPORTED_MODULE_18__.c[curDate.getMonth()],"_").concat(curDate.getFullYear()));case 13:case"end":return _context2.stop()}}),_callee2)})))).apply(this,arguments)}},3380:function(module,exports,__webpack_require__){var api=__webpack_require__(48),content=__webpack_require__(3381);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},3381:function(module,exports,__webpack_require__){(exports=__webpack_require__(49)(!1)).push([module.i,":root{--accent-color--light: #f8f1f1;--accent-color--contrast: #16c79a;--main-color: #4293b6;--main-color--dark: #19456b}.report-table-page{position:relative;background-color:#ffffff;width:intrinsic;width:-moz-max-content;width:-webkit-max-content;width:100%}.report-table-page .main-window{position:relative}.report-table-page .main-window .main-window__title .main-window__button{font-size:60%;margin-left:15px}.report-table-page .main-window .control-panel__buttons{align-items:center;padding-top:5px}.report-table-page .main-window .report-table-page__date{width:fit-content;align-self:flex-start;display:flex;flex-direction:row;margin-right:15px;margin-top:5px;font-size:1rem}.report-table-page .main-window .report-table-page__date .input_date{width:100%;margin-bottom:0px;min-width:200px}.report-table-page .main-window .report-table-page__date .input_date .input_date__input{flex-direction:row;align-items:center;flex-wrap:nowrap !important}.report-table-page .main-window .report-table-page__date .input_date .input_date__input_name{white-space:nowrap;max-width:fit-content}.report-table-page .main-window .report-table-page__date .input_date .react-datepicker{min-width:217px}.report-table-page .main-window .report-table-page__date .input_date .react-datepicker__month-text{padding:5px 0px;border-radius:2.5px}.report-table-page .main-window .report-table-page__date .input_date input{width:100%;max-width:80px}.report-table-page .control-panel{margin-bottom:0px}.report-table-page .control-panel .main-window__button{margin-top:0 !important}.report-table-page .employee-page{display:flex;flex-direction:column;width:100%;padding:5px 30px;box-sizing:border-box}.report-table-page .employee-page .select-employee{margin-bottom:15px}.report-table-page .employee-page .select-employee__input .select-employee__input_name{display:none}.report-table-page .employee-page .select-employee__searchbar{display:none}.report-table-page .employee-page .main-window__button{width:150px;height:2rem}.report-table-page .employee-page .report-table-page__employee-wrapper{padding-left:0}.report-table-page .form-window__content{max-width:600px}.report-table-page__tableview{width:100%;min-width:1000px;align-self:flex-start}.report-table-page__tableview .main-window__title{font-size:20px;display:flex;justify-content:center;align-items:center;padding:10px 25px;margin:0}.report-table-page__tableview .main-window__title .main-window__img{padding:3px 5px;margin:0 5px;cursor:pointer}.report-table-page__tableview .main-window__list{width:fit-content;margin-bottom:20px;min-height:100px;width:intrinsic;width:-moz-max-content;width:-webkit-max-content}.report-table-page__tableview .main-window__list-item{border-top:1px solid #cccccc;border-radius:0 !important;justify-content:flex-start}.report-table-page__tableview .main-window__list-item:not(.main-window__list-item--header){border-bottom:none}.report-table-page__tableview .main-window__list-item:not(.main-window__list-item--header):hover{background-color:#eeeeee}.report-table-page__tableview .main-window__list-item--divider{display:flex;flex-direction:row;justify-content:flex-start;margin:15px 10px;width:calc(100% - 20px);background-color:transparent}.report-table-page__tableview .main-window__list-item--divider span{padding:2.5px 10px;font-size:0.9rem !important}.report-table-page__tableview .main-window__list-item:last-child{border-bottom:1px solid #cccccc}.report-table-page__tableview .main-window__list-item .report-table-page__day--weekend{background-color:#f0c8c855;color:#777777;border-right-color:#e9d0d0 !important}.report-table-page__tableview .main-window__list-item .report-table-page__day--weekend+.report-table-page__day--weekend{border-right-color:#cccccc !important}.report-table-page__tableview .main-window__list .main-window__list-item:not(.main-window__list-item--divider){padding:0 !important;align-items:stretch}.report-table-page__tableview .main-window__list .main-window__list-item:not(.main-window__list-item--divider) span{min-width:40px;min-height:35px;padding:5px 10px;text-align:center}.report-table-page__tableview .main-window__list .main-window__list-item:not(.main-window__list-item--divider) span:nth-child(1){text-align:left;cursor:auto;flex:0 1 100%;min-width:300px;max-width:300px}.report-table-page__tableview .main-window__list .main-window__list-item:not(.main-window__list-item--divider) span:not(:last-child){border:1px solid transparent;border-right:1px solid #dddddd}.report-table-page__tableview .main-window__list .main-window__list-item:not(.main-window__list-item--divider) span:last-child{font-weight:bold;border:1px solid transparent;border-right:1px solid #dddddd}.report-table-page__tableview .main-window__list .main-window__list-item:not(.main-window__list-item--divider) span:last-child .report-table-report__date-hint{font-weight:400}.report-table-page__tableview .main-window__list .report-table-page__workshop-name{border-right:1px solid #cccccc}.report-table-page__tableview .main-window__list .report-table-page__workshop-name span{font-size:0.9rem;border-right:1px solid transparent !important}.report-table-page__tableview .main-window__list .main-window__list-item:not(.main-window__list-item--header) span{display:flex;align-items:center;transition:100ms ease-in-out}.report-table-page__tableview .main-window__list .main-window__list-item:not(.main-window__list-item--header) span .report-table-report__date-hint{color:#777777;transform:scaleY(0);font-size:10px;height:0;transition:100ms ease-in-out}.report-table-page__tableview .main-window__list .main-window__list-item:not(.main-window__list-item--header) span:not(:first-child){display:flex;flex-direction:column !important;display:flex;flex-direction:row;justify-content:center;transition:0ms ease-in-out;cursor:pointer}.report-table-page__tableview .main-window__list .main-window__list-item:not(.main-window__list-item--header) span:not(:first-child):hover{background-color:#fff;color:#000;border-radius:3px;transform:scale(1.3);border-color:#bbbbbb}.report-table-page__tableview .main-window__list .main-window__list-item:not(.main-window__list-item--header) span:not(:first-child):hover .report-table-report__date-hint{transform:scaleY(1);height:10px}.report-table-page__tableview .main-window__list .main-window__list-item:not(.main-window__list-item--header) span:not(:first-child):last-child:hover{border:1px solid #999999}.report-table-page__tableview .main-window__list .main-window__list-item:not(.main-window__list-item--header):hover span{background-color:#eeeeee}.report-table-page__tableview .main-window__list .main-window__list-item--header span{background-color:#ffffff !important;min-height:0 !important;border-bottom:1px solid #ccc}.report-table-page__tableview .main-window__list .main-window__list-item--header span:last-child{display:flex;align-items:center;justify-content:center;font-size:0.8rem}@media (max-width: 768px){.report-table-page .control-panel .report-table-page__date{margin-top:5px}.report-table-page .control-panel .report-table-page__date .input_date__input .input_date__input_name{margin-top:10px}.report-table-page .control-panel .button{margin-top:5px !important}.report-table-page .report-table-page__tableview .main-window__list .main-window__list-item--header{display:flex}.report-table-page .report-table-page__tableview .main-window__list .main-window__list-item{flex-direction:row}.report-table-page .report-table-page__tableview .main-window__list .main-window__list-item span{width:auto;text-align:initial !important;margin-bottom:0}.report-table-page .report-table-page__tableview .main-window__list .main-window__list-item span:first-child{min-width:200px;max-width:200px;position:relative}.report-table-page .report-table-page__employee-info .main-window__list{margin:0 !important;margin-top:15px !important}.report-table-page .report-table-page__employee-info .report-table-page__employee-works-wrapper{padding-left:5px}}\n",""]),module.exports=exports},3589:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var defineProperty=__webpack_require__(15),defineProperty_default=__webpack_require__.n(defineProperty),toConsumableArray=__webpack_require__(18),toConsumableArray_default=__webpack_require__.n(toConsumableArray),slicedToArray=__webpack_require__(7),slicedToArray_default=__webpack_require__.n(slicedToArray),react=(__webpack_require__(196),__webpack_require__(50),__webpack_require__(26),__webpack_require__(35),__webpack_require__(1006),__webpack_require__(0)),work_control=(__webpack_require__(3380),__webpack_require__(467)),App=__webpack_require__(131),FloatingPlus=__webpack_require__(661),asyncToGenerator=__webpack_require__(36),asyncToGenerator_default=__webpack_require__.n(asyncToGenerator),regenerator=__webpack_require__(20),regenerator_default=__webpack_require__.n(regenerator),download=(__webpack_require__(130),__webpack_require__(79),__webpack_require__(2937)),download_default=__webpack_require__.n(download),InputDate=__webpack_require__(2835),SearchBar=__webpack_require__(347),Button=__webpack_require__(197),getReportTableExcel=__webpack_require__(2995),ControlPanel=__webpack_require__(2827),dataObjects=(__webpack_require__(256),__webpack_require__(656),__webpack_require__(657),__webpack_require__(159),__webpack_require__(2837),__webpack_require__(2847)),PlaceholderLoading=__webpack_require__(2824),functions=__webpack_require__(61),workshops=[{name:"ЦехЛЭМЗ",active:!0,minimized:!0,allowedRoles:["ROLE_ADMIN","ROLE_LEMZ","ROLE_DISPATCHER"]},{name:"ЦехЛепсари",active:!0,minimized:!0,allowedRoles:["ROLE_ADMIN","ROLE_LEPSARI","ROLE_DISPATCHER"]},{name:"ЦехЛиговский",active:!0,minimized:!0,allowedRoles:["ROLE_ADMIN","ROLE_LIGOVSKIY","ROLE_DISPATCHER"]},{name:"Офис",active:!0,minimized:!0,allowedRoles:["ROLE_ADMIN","ROLE_DISPATCHER","ROLE_MANAGER","ROLE_ENGINEER"]}],ReportTablePage_functions=__webpack_require__(2920),chevron_down=__webpack_require__(2848),chevron_down_default=__webpack_require__.n(chevron_down),jsx_runtime=__webpack_require__(1),TableView_TableView=function TableView(props){return Object(react.useEffect)((function(){}),[props.date]),Object(jsx_runtime.jsxs)("div",{className:"report-table-page__tableview",children:[Object(jsx_runtime.jsx)(TableView_HalfOfTheMonthList,{title:function title(){return Object(jsx_runtime.jsxs)("div",{className:"main-window__title",children:[Object(jsx_runtime.jsx)("img",{className:"main-window__img",style:{transform:"rotate(90deg)"},onClick:function onClick(){var newDate=new Date(new Date(props.date).setMonth(props.date.getMonth()-1));props.setDate(newDate)},title:"Пред. месяц",src:chevron_down_default.a}),Object(jsx_runtime.jsx)("div",{children:"1/2 ".concat(dataObjects.c[props.date.getMonth()]," ").concat(props.date.getFullYear())}),Object(jsx_runtime.jsx)("img",{className:"main-window__img",style:{transform:"rotate(-90deg)"},onClick:function onClick(){var newDate=new Date(new Date(props.date).setMonth(props.date.getMonth()+1));props.setDate(newDate)},title:"След. месяц",src:chevron_down_default.a})]})},dates:props.dates.filter((function(date){return date<16})),userContext:props.userContext,isLoading:props.isLoading,setSelectedInfo:props.setSelectedInfo,date:props.date,workData:props.workData,searchQuery:props.searchQuery,setShowWindow:props.setShowWindow,datesComparison:function datesComparison(index){return index<15}}),Object(jsx_runtime.jsx)(TableView_HalfOfTheMonthList,{title:function title(){return Object(jsx_runtime.jsxs)("div",{className:"main-window__title",children:[Object(jsx_runtime.jsx)("img",{className:"main-window__img",style:{transform:"rotate(90deg)"},onClick:function onClick(){var newDate=new Date(new Date(props.date).setMonth(props.date.getMonth()-1));props.setDate(newDate)},title:"Пред. месяц",src:chevron_down_default.a}),Object(jsx_runtime.jsx)("div",{children:"2/2 ".concat(dataObjects.c[props.date.getMonth()]," ").concat(props.date.getFullYear())}),Object(jsx_runtime.jsx)("img",{className:"main-window__img",style:{transform:"rotate(-90deg)"},onClick:function onClick(){var newDate=new Date(new Date(props.date).setMonth(props.date.getMonth()+1));props.setDate(newDate)},title:"След. месяц",src:chevron_down_default.a})]})},dates:props.dates.filter((function(date){return date>15})),userContext:props.userContext,isLoading:props.isLoading,setSelectedInfo:props.setSelectedInfo,date:props.date,workData:props.workData,searchQuery:props.searchQuery,setShowWindow:props.setShowWindow,datesComparison:function datesComparison(index){return index>14}})]})};TableView_TableView.displayName="TableView",TableView_TableView.__docgenInfo={description:"",methods:[],displayName:"TableView"};var SummaryPage_TableView=TableView_TableView,TableView_HalfOfTheMonthList=function HalfOfTheMonthList(_ref){var title=_ref.title,dates=_ref.dates,userContext=_ref.userContext,isLoading=_ref.isLoading,workData=_ref.workData,setSelectedInfo=_ref.setSelectedInfo,date=_ref.date,searchQuery=_ref.searchQuery,setShowWindow=_ref.setShowWindow,datesComparison=_ref.datesComparison,filterEmployeesData=function filterEmployeesData(data,workshop){return data.filter((function(item){return(item.employee.lastName.toLowerCase().includes(searchQuery.toLowerCase())||item.employee.name.toLowerCase().includes(searchQuery.toLowerCase())||item.employee.middleName.toLowerCase().includes(searchQuery.toLowerCase()))&&item.employee.workshop===workshop.name}))};return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[title(),Object(jsx_runtime.jsxs)("div",{className:"main-window__list",children:[Object(jsx_runtime.jsxs)("div",{className:"main-window__list-item main-window__list-item--header",children:[Object(jsx_runtime.jsx)("span",{children:"ФИО сотрудника"}),dates.map((function(dateItem,index){var weekday=new Date(new Date(date).setDate(dateItem)).getDay();return Object(jsx_runtime.jsx)("span",{className:6===weekday||0===weekday?"report-table-page__day--weekend":"",children:dateItem},index)})),Object(jsx_runtime.jsx)("span",{children:"Сумма"})]}),workshops.filter((function(workshop){return userContext.userHasAccess(workshop.allowedRoles)})).map((function(workshop){if(0!==Object(ReportTablePage_functions.b)(filterEmployeesData(Object.values(workData),workshop)).length||isLoading)return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("div",{className:"main-window__list-item report-table-page__workshop-name",children:Object(jsx_runtime.jsx)("span",{children:workshop.name})}),isLoading?Object(jsx_runtime.jsx)(PlaceholderLoading.a,{itemClassName:"main-window__list-item",minHeight:"45px",items:3}):Object(ReportTablePage_functions.b)(filterEmployeesData(Object.values(workData),workshop)).map((function(work){var fullEmployeeName=Object(functions.p)(work.employee);return Object(jsx_runtime.jsxs)("div",{className:"main-window__list-item",children:[Object(jsx_runtime.jsx)("span",{children:fullEmployeeName}),Object.values(work.works).map((function(workItem,workItemIndex){if(datesComparison(workItemIndex)){var weekday=new Date(new Date(date).setDate(workItem.length>0?workItem[0].day:workItem.day)).getDay(),startDate=new Date(date.getFullYear(),date.getMonth(),workItem.length>0?workItem[0].day:workItem.day);return Object(jsx_runtime.jsxs)("span",{onClick:function onClick(){setSelectedInfo({employeeId:work.employee.id,employee:work.employee,day:workItem.length>0?workItem[0].day:workItem.day,month:date.getMonth()+1,year:date.getFullYear(),selectedDay:{startDate:startDate},works:workItem}),setShowWindow(!0)},className:6===weekday||0===weekday?"report-table-page__day--weekend":"",children:[Object(jsx_runtime.jsx)("div",{className:"report-table-report__date-hint",children:Object(functions.h)(new Date(startDate))}),0===workItem.hours?" ":workItem.reduce((function(sum,cur){return sum+cur.hours}),0)]})}})),Object(jsx_runtime.jsxs)("span",{onClick:function onClick(){var filteredData=Object.values(work.works).filter((function(item,workItemIndex){return datesComparison(workItemIndex)}));setSelectedInfo({employeeId:work.employee.id,employee:work.employee,works:work.workArray.length>0?filteredData:[],selectedDay:{startDate:new Date(date.getFullYear(),date.getMonth(),dates[0]),endDate:new Date(date.getFullYear(),date.getMonth(),dates[dates.length-1])}}),setShowWindow(!0)},children:[Object(jsx_runtime.jsx)("div",{className:"report-table-report__date-hint",children:"Итог"}),Object.values(work.works).reduce((function(sum,item,index){return item.length>0&&datesComparison(index)?sum+item.reduce((function(sum,cur){return sum+cur.hours}),0):sum}),0)]})]},work.id)}))]})}))]})]})};"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MainPage/GeneralPage/ReportTablePage/SummaryPage/TableView.jsx"]={name:"TableView",docgenInfo:TableView_TableView.__docgenInfo,path:"src/components/MainPage/GeneralPage/ReportTablePage/SummaryPage/TableView.jsx"});var FormWindow=__webpack_require__(199),EmployeeInfo_EmployeeInfo=__webpack_require__(3103),InfoComponents_EmployeeInfo=function EmployeeInfo(props){return Object(react.useEffect)((function(){}),[props.dates]),Object(jsx_runtime.jsx)("div",{className:"report-table-page__employee-info",children:Object(jsx_runtime.jsx)(FormWindow.a,{title:"Отчет работника",showWindow:props.showWindow,setShowWindow:props.setShowWindow,content:Object(jsx_runtime.jsx)(EmployeeInfo_EmployeeInfo.a,{dates:props.dates,header:props.header,selectedInfo:props.selectedInfo})})})};InfoComponents_EmployeeInfo.displayName="EmployeeInfo",InfoComponents_EmployeeInfo.__docgenInfo={description:"",methods:[],displayName:"EmployeeInfo"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MainPage/GeneralPage/ReportTablePage/SummaryPage/InfoComponents.jsx"]={name:"EmployeeInfo",docgenInfo:InfoComponents_EmployeeInfo.__docgenInfo,path:"src/components/MainPage/GeneralPage/ReportTablePage/SummaryPage/InfoComponents.jsx"});var time=__webpack_require__(2926),SummaryPage_SummaryPage=function SummaryPage(_ref){var _selectedInfo$selecte,_selectedInfo$selecte2,_selectedInfo$selecte3,_selectedInfo$selecte4,_selectedInfo$selecte5,_selectedInfo$selecte6,setSearchQuery=_ref.setSearchQuery,isLoading=_ref.isLoading,excelIsLoading=_ref.excelIsLoading,setExcelIsLoading=_ref.setExcelIsLoading,date=_ref.date,setDate=_ref.setDate,showWindow=_ref.showWindow,setShowWindow=_ref.setShowWindow,selectedInfo=_ref.selectedInfo,dates=_ref.dates,workList=_ref.workList,setSelectedInfo=_ref.setSelectedInfo,searchQuery=_ref.searchQuery,userContext=_ref.userContext;return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(SearchBar.a,{fullSize:!0,placeholder:"Введите запрос для поиска по сотрудникам...",setSearchQuery:setSearchQuery}),Object(jsx_runtime.jsx)(ControlPanel.a,{buttons:Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("div",{className:"report-table-page__date",children:Object(jsx_runtime.jsx)(InputDate.a,{selected:Date.parse(date),inputName:"Выбор месяца:",handleDateChange:function handleDateChange(date){return setDate(date)},showMonthYearPicker:!0})}),Object(jsx_runtime.jsx)(Button.a,{text:"Скачать .xlsx",imgSrc:download_default.a,className:"main-window__button main-window__button--inverted",inverted:!0,isLoading:isLoading||excelIsLoading,onClick:asyncToGenerator_default()(regenerator_default.a.mark((function _callee(){var filteredWorkshops;return regenerator_default.a.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return setExcelIsLoading(!0),filteredWorkshops=["ЦехЛЭМЗ","ЦехЛепсари","ЦехЛиговский","Офис","Уволенные"],_context.next=4,Object(getReportTableExcel.a)(new Date(date),filteredWorkshops);case 4:setExcelIsLoading(!1);case 5:case"end":return _context.stop()}}),_callee)})))})]})}),Object(jsx_runtime.jsx)(InfoComponents_EmployeeInfo,{showWindow:showWindow,setShowWindow:setShowWindow,header:null!=selectedInfo&&null!==(_selectedInfo$selecte=selectedInfo.selectedDay)&&void 0!==_selectedInfo$selecte&&_selectedInfo$selecte.endDate?"Отчет за период ".concat(Object(functions.g)(null===(_selectedInfo$selecte2=selectedInfo.selectedDay)||void 0===_selectedInfo$selecte2?void 0:_selectedInfo$selecte2.startDate)," - ").concat(Object(functions.g)(null===(_selectedInfo$selecte3=selectedInfo.selectedDay)||void 0===_selectedInfo$selecte3?void 0:_selectedInfo$selecte3.endDate)):Object(functions.g)(null===(_selectedInfo$selecte4=selectedInfo.selectedDay)||void 0===_selectedInfo$selecte4?void 0:_selectedInfo$selecte4.startDate),dates:null!=selectedInfo&&null!==(_selectedInfo$selecte5=selectedInfo.selectedDay)&&void 0!==_selectedInfo$selecte5&&_selectedInfo$selecte5.endDate?Object(time.a)(selectedInfo.selectedDay.startDate,selectedInfo.selectedDay.endDate):[null==selectedInfo||null===(_selectedInfo$selecte6=selectedInfo.selectedDay)||void 0===_selectedInfo$selecte6?void 0:_selectedInfo$selecte6.startDate],selectedInfo:selectedInfo}),Object(jsx_runtime.jsx)(SummaryPage_TableView,{dates:dates,workData:workList,showWindow:showWindow,isLoading:isLoading,setShowWindow:setShowWindow,setSelectedInfo:setSelectedInfo,date:date,setDate:setDate,userContext:userContext,searchQuery:searchQuery})]})};SummaryPage_SummaryPage.__docgenInfo={description:"",methods:[],displayName:"SummaryPage"};var ReportTablePage_SummaryPage_SummaryPage=SummaryPage_SummaryPage;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MainPage/GeneralPage/ReportTablePage/SummaryPage/SummaryPage.jsx"]={name:"SummaryPage",docgenInfo:SummaryPage_SummaryPage.__docgenInfo,path:"src/components/MainPage/GeneralPage/ReportTablePage/SummaryPage/SummaryPage.jsx"});var ReportTablePage_ReportTablePage_ReportTablePage=function ReportTablePage(){var _useState=Object(react.useState)(new Date),_useState2=slicedToArray_default()(_useState,2),date=_useState2[0],setDate=_useState2[1],_useState3=Object(react.useState)(!1),_useState4=slicedToArray_default()(_useState3,2),isLoading=_useState4[0],setIsLoading=_useState4[1],_useState5=Object(react.useState)(!1),_useState6=slicedToArray_default()(_useState5,2),excelIsLoading=_useState6[0],setExcelIsLoading=_useState6[1],_useState7=Object(react.useState)([]),_useState8=slicedToArray_default()(_useState7,2),dates=_useState8[0],setDates=_useState8[1],_useState9=Object(react.useState)({}),_useState10=slicedToArray_default()(_useState9,2),workList=_useState10[0],setWorkList=_useState10[1],_useState11=Object(react.useState)(!1),_useState12=slicedToArray_default()(_useState11,2),showWindow=_useState12[0],setShowWindow=_useState12[1],_useState13=Object(react.useState)({}),_useState14=slicedToArray_default()(_useState13,2),selectedInfo=_useState14[0],setSelectedInfo=_useState14[1],_useState15=Object(react.useState)(""),_useState16=slicedToArray_default()(_useState15,2),searchQuery=_useState16[0],setSearchQuery=_useState16[1],userContext=Object(react.useContext)(App.a);return Object(react.useEffect)((function(){document.title="Табель";var abortController=new AbortController;return function getAllEmployeesWorkData(date,signal){setIsLoading(!0);var curDate=date,dates=Object(ReportTablePage_functions.a)(curDate);setDates(toConsumableArray_default()(dates));var employeesWorkList={};Object(work_control.j)(curDate.getMonth()+1,curDate.getFullYear(),signal).then((function(res){return res.json()})).then((function(res){return res.map((function(workItem){return employeesWorkList=Object.assign(Object.assign({},employeesWorkList,defineProperty_default()({},workItem.employee.id,{employee:workItem.employee,workArray:[].concat(toConsumableArray_default()(void 0!==employeesWorkList[workItem.employee.id]?employeesWorkList[workItem.employee.id].workArray:[]),[{workId:workItem.id,workControlProduct:workItem.workControlProduct,partsWorks:workItem.partsWorks,workList:workItem.workList,day:workItem.day,month:workItem.month,year:workItem.year,hours:workItem.hours,comment:workItem.comment}])})))}))})).then((function(){var newWorkList=employeesWorkList;return Object.values(employeesWorkList).map((function(item){item.workArray.map((function(workItem){var _newWorkList$item$emp,prevWorks=void 0===newWorkList[item.employee.id].works||void 0===(null===(_newWorkList$item$emp=newWorkList[item.employee.id])||void 0===_newWorkList$item$emp?void 0:_newWorkList$item$emp.works[workItem.day])?[]:newWorkList[item.employee.id].works[workItem.day];newWorkList=Object.assign(Object.assign({},newWorkList,defineProperty_default()({},item.employee.id,Object.assign({},newWorkList[item.employee.id],{works:Object.assign({},newWorkList[item.employee.id].works,defineProperty_default()({},workItem.day,[].concat(toConsumableArray_default()(prevWorks),[{workId:workItem.workId,workControlProduct:workItem.workControlProduct,partsWorks:workItem.partsWorks,workList:workItem.workList,day:workItem.day,month:workItem.month,year:workItem.year,hours:workItem.hours,comment:workItem.comment}])))}))))}))})),employeesWorkList=newWorkList})).then((function(){var newWorkList=employeesWorkList;return Object.values(employeesWorkList).map((function(item){dates.map((function(date){void 0===item.works[date]&&(newWorkList=Object.assign(Object.assign({},newWorkList,defineProperty_default()({},item.employee.id,Object.assign({},newWorkList[item.employee.id],{works:Object.assign({},newWorkList[item.employee.id].works,defineProperty_default()({},date,{day:date,hours:0}))})))))}))})),console.log(newWorkList),setIsLoading(!1),setWorkList(Object.assign({},newWorkList))}))}(date,abortController.signal),function cancel(){abortController.abort()}}),[date]),Object(jsx_runtime.jsx)("div",{className:"report-table-page",children:Object(jsx_runtime.jsxs)("div",{className:"main-window",children:[Object(jsx_runtime.jsx)("div",{className:"main-window__header main-window__header--full",children:Object(jsx_runtime.jsx)("div",{className:"main-window__title",children:"Табель"})}),Object(jsx_runtime.jsx)(FloatingPlus.a,{linkTo:"/work-management/record-time",visibility:["ROLE_ADMIN","ROLE_DISPATCHER"]}),Object(jsx_runtime.jsx)(ReportTablePage_SummaryPage_SummaryPage,{isLoading:isLoading,excelIsLoading:excelIsLoading,setExcelIsLoading:setExcelIsLoading,date:date,setDate:setDate,showWindow:showWindow,setShowWindow:setShowWindow,selectedInfo:selectedInfo,dates:dates,workList:workList,setSelectedInfo:setSelectedInfo,searchQuery:searchQuery,setSearchQuery:setSearchQuery,userContext:userContext})]})})};ReportTablePage_ReportTablePage_ReportTablePage.displayName="ReportTablePage",ReportTablePage_ReportTablePage_ReportTablePage.__docgenInfo={description:"",methods:[],displayName:"ReportTablePage"};__webpack_exports__.default=ReportTablePage_ReportTablePage_ReportTablePage;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MainPage/GeneralPage/ReportTablePage/ReportTablePage.jsx"]={name:"ReportTablePage",docgenInfo:ReportTablePage_ReportTablePage_ReportTablePage.__docgenInfo,path:"src/components/MainPage/GeneralPage/ReportTablePage/ReportTablePage.jsx"})}}]);
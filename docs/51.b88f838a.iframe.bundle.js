(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{2855:function(module,__webpack_exports__,__webpack_require__){"use strict";var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(7),_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__),react__WEBPACK_IMPORTED_MODULE_4__=(__webpack_require__(23),__webpack_require__(36),__webpack_require__(51),__webpack_require__(0)),prop_types__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(2),prop_types__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_5__),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__=(__webpack_require__(2856),__webpack_require__(1)),PlaceholderLoading=function PlaceholderLoading(_ref){var _ref$items=_ref.items,items=void 0===_ref$items?3:_ref$items,itemClassName=_ref.itemClassName,_ref$minHeight=_ref.minHeight,minHeight=void 0===_ref$minHeight?"1.5rem":_ref$minHeight,placeholderContent=_ref.placeholderContent,wrapperClassName=_ref.wrapperClassName,_ref$itemStyles=_ref.itemStyles,itemStyles=void 0===_ref$itemStyles?{}:_ref$itemStyles,_useState=Object(react__WEBPACK_IMPORTED_MODULE_4__.useState)([]),_useState2=_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_useState,2),elements=_useState2[0],setElements=_useState2[1];return Object(react__WEBPACK_IMPORTED_MODULE_4__.useEffect)((function(){for(var temp=[],count=items,i=1;i<=count;i++)temp.push(Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)("div",{className:"placeholder-loading__item ".concat(itemClassName),style:Object.assign({minHeight:minHeight},itemStyles)}));setElements([].concat(temp))}),[]),placeholderContent?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)("div",{className:"placeholder-loading ".concat(wrapperClassName),children:elements.map((function(item,index){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)("div",{className:itemClassName,style:{minHeight:minHeight},children:placeholderContent},index)}))}):Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)("div",{className:"placeholder-loading ".concat(wrapperClassName),children:elements.map((function(item){return item}))})};PlaceholderLoading.displayName="PlaceholderLoading",PlaceholderLoading.__docgenInfo={description:"",methods:[],displayName:"PlaceholderLoading",props:{items:{defaultValue:{value:"3",computed:!1},type:{name:"number"},required:!1,description:""},minHeight:{defaultValue:{value:"'1.5rem'",computed:!1},type:{name:"string"},required:!1,description:""},itemStyles:{defaultValue:{value:"{}",computed:!1},type:{name:"object"},required:!1,description:""},itemClassName:{type:{name:"string"},required:!1,description:""},wrapperClassName:{type:{name:"string"},required:!1,description:""},placeholderContent:{type:{name:"any"},required:!1,description:""}}},__webpack_exports__.a=PlaceholderLoading,PlaceholderLoading.propTypes={items:prop_types__WEBPACK_IMPORTED_MODULE_5___default.a.number,minHeight:prop_types__WEBPACK_IMPORTED_MODULE_5___default.a.string,itemClassName:prop_types__WEBPACK_IMPORTED_MODULE_5___default.a.string,wrapperClassName:prop_types__WEBPACK_IMPORTED_MODULE_5___default.a.string,placeholderContent:prop_types__WEBPACK_IMPORTED_MODULE_5___default.a.any,itemStyles:prop_types__WEBPACK_IMPORTED_MODULE_5___default.a.object},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/TableView/PlaceholderLoading/PlaceholderLoading.jsx"]={name:"PlaceholderLoading",docgenInfo:PlaceholderLoading.__docgenInfo,path:"src/components/TableView/PlaceholderLoading/PlaceholderLoading.jsx"})},2856:function(module,exports,__webpack_require__){var api=__webpack_require__(45),content=__webpack_require__(2857);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},2857:function(module,exports,__webpack_require__){(exports=__webpack_require__(46)(!1)).push([module.i,'@keyframes pulse-placeholder-loading{0%,100%{background-color:#e7e7e7}50%{background-color:#efefef}}@keyframes load{from{left:-150px}to{left:100%}}.placeholder-loading__item{height:1rem;background-color:#ddd;animation:pulse-placeholder-loading 1s infinite ease-in-out;position:relative;overflow:hidden;border-bottom:1px solid #bbb}.placeholder-loading__item::after{content:"";display:block;position:absolute;left:-150px;top:0;height:100%;width:150px;background:linear-gradient(to right, transparent 0%, #e8e8e8 50%, transparent 100%);animation:load 1s cubic-bezier(0.4, 0, 0.2, 1) infinite}\n',""]),module.exports=exports},2875:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__(36);var prop_types__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2),prop_types__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_1__),react_router_dom__WEBPACK_IMPORTED_MODULE_3__=(__webpack_require__(2876),__webpack_require__(47)),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(1),Widget=function Widget(_ref){var _ref$title=_ref.title,title=void 0===_ref$title?"":_ref$title,_ref$className=_ref.className,className=void 0===_ref$className?"":_ref$className,_ref$content=_ref.content,content=void 0===_ref$content?null:_ref$content,linkTo=_ref.linkTo,_ref$subTitle=_ref.subTitle,subTitle=void 0===_ref$subTitle?"":_ref$subTitle,_ref$customHeader=_ref.customHeader,customHeader=void 0===_ref$customHeader?null:_ref$customHeader,_ref$miniWidget=_ref.miniWidget,miniWidget=void 0!==_ref$miniWidget&&_ref$miniWidget,_ref$icon=_ref.icon,icon=void 0===_ref$icon?null:_ref$icon;return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsxs)("div",{className:"widget ".concat(null!=className?className:""," ").concat(miniWidget?"widget--mini":""),children:[null!=customHeader?customHeader:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsxs)("div",{className:"widget__title",children:[!miniWidget&&Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("div",{className:"widget__sub-title",children:subTitle}),linkTo?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(react_router_dom__WEBPACK_IMPORTED_MODULE_3__.a,{to:linkTo.address,title:linkTo.text,children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsxs)("span",{children:[icon,title]})}):Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsxs)("span",{children:[icon,title]})]}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("div",{className:"widget__content",children:content})]})};Widget.displayName="Widget",Widget.__docgenInfo={description:"",methods:[],displayName:"Widget",props:{title:{defaultValue:{value:"''",computed:!1},required:!1},className:{defaultValue:{value:"''",computed:!1},required:!1},content:{defaultValue:{value:"null",computed:!1},required:!1},subTitle:{defaultValue:{value:"''",computed:!1},required:!1},customHeader:{defaultValue:{value:"null",computed:!1},required:!1},miniWidget:{defaultValue:{value:"false",computed:!1},required:!1},icon:{defaultValue:{value:"null",computed:!1},required:!1}}},__webpack_exports__.a=Widget,Widget.proptypes={title:prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.string,className:prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.string,linkTo:prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.object,subTitle:prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.string,customHeader:prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.object,miniWidget:prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.bool,icon:prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.any},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MainPage/GeneralPage/Widget/Widget.jsx"]={name:"Widget",docgenInfo:Widget.__docgenInfo,path:"src/components/MainPage/GeneralPage/Widget/Widget.jsx"})},2876:function(module,exports,__webpack_require__){var api=__webpack_require__(45),content=__webpack_require__(2877);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},2877:function(module,exports,__webpack_require__){(exports=__webpack_require__(46)(!1)).push([module.i,":root{--accent-color--light: #f8f1f1;--accent-color--contrast: #16c79a;--main-color: #4293b6;--main-color--dark: #19456b}.widget{display:flex;flex-direction:column;justify-content:flex-start;align-items:flex-start;box-sizing:border-box;position:relative;width:100%;background-color:#fff;border:1px solid #ddd;border-radius:10px;padding:9px 26px;padding-top:15px;min-width:300px;max-width:600px;max-height:360px;margin-bottom:15px;margin-right:15px}.widget--mini{max-width:none;height:fit-content;max-height:Max(calc(33.33vh - 62px), 120px)}.widget--mini .widget__content{height:fit-content}.widget--mini:last-child{margin-bottom:0}.widget__title{display:flex;flex-direction:row-reverse;justify-content:flex-start;align-items:center;font-size:1.25rem;position:relative;margin-bottom:5px;width:100%}.widget__title .widget__sub-title{font-size:0.9rem;color:#444}.widget__title>a{color:#333;margin-right:auto;transition:100ms ease-in-out;font-weight:500}.widget__title>a:hover{color:#bbb}.widget__title>span{display:flex;align-items:center;margin-right:auto;font-weight:500}.widget__title>span .main-window__img{filter:none !important}.widget__content{width:100%;height:100%;overflow-y:auto;box-sizing:border-box;padding-right:4px}.widget__content::-webkit-scrollbar-track,.widget__content *::-webkit-scrollbar-track{-webkit-box-shadow:inset 0 0 6px rgba(0,0,0,0.3);border-radius:10px;background-color:#f9f9f9}.widget__content::-webkit-scrollbar,.widget__content *::-webkit-scrollbar{width:8px;border-radius:10px;background-color:#f9f9f9}.widget__content::-webkit-scrollbar-thumb,.widget__content *::-webkit-scrollbar-thumb{border-radius:10px;-webkit-box-shadow:inset 0 0 6px rgba(0,0,0,0.3);background-color:#ddd}@media (max-width: 1350px){.widget{max-width:500px}}@media (max-width: 768px){.widget{max-width:100%;width:100%;margin-right:0;padding:15px 20px;padding-bottom:10px}}@media (max-width: 500px){.widget{max-height:calc(360px + 50px)}.widget__title{margin-top:2px;position:initial}.widget__title .main-window__button{position:absolute;margin-top:0;bottom:9px;left:20px}}\n",""]),module.exports=exports},3100:function(module,exports,__webpack_require__){var api=__webpack_require__(45),content=__webpack_require__(3533);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},3532:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/bx-window-open.c9bf8a61.svg"},3533:function(module,exports,__webpack_require__){(exports=__webpack_require__(46)(!1)).push([module.i,":root{--accent-color--light: #f8f1f1;--accent-color--contrast: #16c79a;--main-color: #4293b6;--main-color--dark: #19456b}.work-list-widget .widget__content{padding-right:0}.work-list-widget__info{font-size:1rem;margin-top:5px;margin-bottom:5px;color:#666666}.work-list-widget .work-list-widget__list{display:flex;height:100%;flex-direction:column;margin:0 auto;overflow-y:auto;font-size:100%;box-sizing:border-box;padding-right:4px}.work-list-widget .work-list-widget__list .work-list-widget__workshop-item{margin-right:auto;margin-bottom:5px;color:#666666;font-size:85%;width:max-content;white-space:nowrap;margin-bottom:5px}.work-list-widget .work-list-widget__list .work-list-widget__workshop-item:not(:first-child){margin-top:5px}.work-list-widget .work-list-widget__list .work-list-widget__workshop-group:not(:first-child){margin-top:8px}.work-list-widget .work-list-widget__list--placeholder .work-list-widget__item:first-child{border-top-left-radius:3px;border-top-right-radius:3px}.work-list-widget .work-list-widget__list--placeholder .work-list-widget__item:nth-child(2){border-top-left-radius:0;border-top-right-radius:0}.work-list-widget .work-list-widget__item{border:1px solid #ddd;padding:5px 10px;width:100%;font-size:85%;cursor:pointer;display:flex;justify-content:space-between;position:relative;transition:100ms ease-in-out;color:#444444;box-sizing:border-box}.work-list-widget .work-list-widget__item:hover{background-color:#efefef}.work-list-widget .work-list-widget__item:nth-child(2){border-top-left-radius:3px;border-top-right-radius:3px}.work-list-widget .work-list-widget__item:last-child{border-bottom-left-radius:3px;border-bottom-right-radius:3px}.work-list-widget .work-list-widget__item:not(:last-child){border-bottom:none}.work-list-widget .work-list-widget__item--no-data{background-color:#fdf6f6;border-color:#e2dbdb;color:#555555}.work-list-widget .work-list-widget__item--no-data .work-list-widget__info-message{font-size:0.85rem;color:#a4746a}.work-list-widget .work-list-widget__item--no-data:hover{background-color:#eee0e2}.work-list-widget .work-list-widget__item>div:nth-child(1){flex:0 1 100%;text-align:left;padding-right:10px}.work-list-widget .work-list-widget__item>div:nth-child(2){flex:0 1 50%;max-width:100px;text-align:left;text-align:right}@media (max-width: 768px){.work-list-widget .work-list-widget__content .work-list-widget__list{width:100%;padding:0;padding-right:2px}.work-list-widget .work-list-widget__item{flex-direction:column;align-items:flex-start}}\n",""]),module.exports=exports},3560:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var defineProperty=__webpack_require__(15),defineProperty_default=__webpack_require__.n(defineProperty),slicedToArray=__webpack_require__(7),slicedToArray_default=__webpack_require__.n(slicedToArray),react=(__webpack_require__(134),__webpack_require__(83),__webpack_require__(166),__webpack_require__(154),__webpack_require__(202),__webpack_require__(51),__webpack_require__(23),__webpack_require__(201),__webpack_require__(0)),react_router=__webpack_require__(151),bx_window_open=__webpack_require__(3532),bx_window_open_default=__webpack_require__.n(bx_window_open),work_control=__webpack_require__(480),functions=__webpack_require__(63),App=__webpack_require__(135),PlaceholderLoading=__webpack_require__(2855),workshopsList=[{name:"ЦехЛЭМЗ",visibility:["ROLE_ADMIN","ROLE_LEMZ","ROLE_DISPATCHER"],active:!0},{name:"ЦехЛепсари",visibility:["ROLE_ADMIN","ROLE_LEPSARI","ROLE_DISPATCHER"],active:!0},{name:"ЦехЛиговский",visibility:["ROLE_ADMIN","ROLE_LIGOVSKIY","ROLE_DISPATCHER","ROLE_MANAGER"],active:!0},{name:"Офис",visibility:["ROLE_ADMIN","ROLE_DISPATCHER","ROLE_MANAGER","ROLE_ENGINEER"],active:!0}],sortEmployeesObject=(__webpack_require__(1017),__webpack_require__(257),__webpack_require__(165),__webpack_require__(36),__webpack_require__(1016),__webpack_require__(674),__webpack_require__(3100),__webpack_require__(476),function sortEmployeesObject(employees){return employees.sort((function(a,b){return a[1].lastName<b[1].lastName?-1:a[1].lastName>b[1].lastName?1:0}))}),react_router_dom=__webpack_require__(47),jsx_runtime=__webpack_require__(1),WorkList_WorkList=function WorkList(_ref){var workshops=_ref.workshops,employees=_ref.employees,employeesMap=_ref.employeesMap,userContext=_ref.userContext,_ref$date=_ref.date,date=void 0===_ref$date?new Date:_ref$date;return Object(jsx_runtime.jsx)("div",{className:"work-list-widget__list",children:workshops.map((function(workshop){var filteredEmployees=function filterEmployeesObject(employees,workshop){return employees.filter((function(employee){if(employee[1].workshop===workshop.name)return!0}))}(Object.entries(employees),workshop);if(userContext.userHasAccess(workshop.visibility)&&filteredEmployees.filter((function(item){return employeesMap[item[1].id]})).length>0)return Object(jsx_runtime.jsxs)("div",{className:"work-list-widget__workshop-group",children:[Object(jsx_runtime.jsx)("div",{className:"work-list-widget__workshop-item",children:workshop.name}),sortEmployeesObject(filteredEmployees).map((function(employee){var item=employee[1];return Object(jsx_runtime.jsx)(WorkList_ListItem,{date:date,item:item,employeesMap:employeesMap},employee.id)}))]})}))})};WorkList_WorkList.displayName="WorkList",WorkList_WorkList.__docgenInfo={description:"",methods:[],displayName:"WorkList",props:{date:{defaultValue:{value:"new Date()",computed:!1},required:!1}}};var WorkListWidget_WorkList=WorkList_WorkList,WorkList_ListItem=function ListItem(_ref2){var _employeesMap$item$id,_employeesMap$item$id2,item=_ref2.item,employeesMap=_ref2.employeesMap,_ref2$date=_ref2.date,date=void 0===_ref2$date?new Date:_ref2$date;return employeesMap[item.id]||0!==(new Date).getDay()&&1!==(new Date).getDay()?Object(jsx_runtime.jsxs)(react_router_dom.a,{to:"/work-management/record-time?employee=".concat(item.id,"&date=").concat(date.getFullYear(),",").concat(date.getMonth()+1,",").concat(date.getDate()),className:"work-list-widget__item ".concat(employeesMap[item.id]?"":"work-list-widget__item--no-data"),target:"_blank",children:[Object(jsx_runtime.jsx)("div",{children:item.lastName+" "+item.name+" "+item.middleName}),Object(jsx_runtime.jsx)("div",{children:void 0!==employeesMap[item.id]&&void 0!==employeesMap?Object(functions.t)(null===(_employeesMap$item$id=employeesMap[item.id])||void 0===_employeesMap$item$id?void 0:_employeesMap$item$id.hours)+" "+Object(functions.s)(Number.parseInt(Object(functions.t)(null===(_employeesMap$item$id2=employeesMap[item.id])||void 0===_employeesMap$item$id2?void 0:_employeesMap$item$id2.hours)),["час","часа","часов"]):Object(jsx_runtime.jsx)("span",{className:"work-list-widget__info-message",children:"Нет записи"})})]},item.id):null};"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MainPage/GeneralPage/WorkManagement/WorkListWidget/WorkList.jsx"]={name:"WorkList",docgenInfo:WorkList_WorkList.__docgenInfo,path:"src/components/MainPage/GeneralPage/WorkManagement/WorkListWidget/WorkList.jsx"});var Widget=__webpack_require__(2875),useEmployeesList=__webpack_require__(1039),WorkListWidget_WorkListWidget_WorkListWidget=function WorkListWidget(){var _useState=Object(react.useState)(!1),_useState2=slicedToArray_default()(_useState,2),isLoading=_useState2[0],setIsLoading=_useState2[1],_useState3=Object(react.useState)([]),_useState4=slicedToArray_default()(_useState3,2),recordedWork=_useState4[0],setRecordedWork=_useState4[1],_useState5=Object(react.useState)({}),_useState6=slicedToArray_default()(_useState5,2),employeesMap=_useState6[0],setEmployeesMap=_useState6[1],_useEmployeesList=Object(useEmployeesList.a)(),employees=_useEmployeesList.employees,isLoadingEmployees=_useEmployeesList.isLoadingEmployees,userContext=Object(react.useContext)(App.a);return Object(react.useEffect)((function(){var abortController=new AbortController,date=new Date;return date.setDate(date.getDate()-1),setIsLoading(!0),0===recordedWork.length&&Object(work_control.i)(date.getMonth()+1,date.getDate(),date.getFullYear(),abortController.signal).then((function(res){return res.json()})).then((function(res){setRecordedWork(res),function combineWorkHoursForSamePeople(works){var newEmployeesMap={};Promise.all(works.map((function(work){return newEmployeesMap=Object.assign({},newEmployeesMap,defineProperty_default()({},work.employee.id,{hours:void 0!==newEmployeesMap[work.employee.id]?newEmployeesMap[work.employee.id].hours+work.hours:work.hours}))}))).then((function(){setEmployeesMap(newEmployeesMap)}))}(res),setIsLoading(!1)})).catch((function(error){console.log(error),setIsLoading(!1)})),function cancel(){abortController.abort()}}),[]),Object(jsx_runtime.jsx)(Widget.a,{className:"work-list-widget",title:"Отчет производства",subTitle:Object(functions.f)(new Date((new Date).setDate((new Date).getDate()-1))),linkTo:{address:"/work-management",text:"Открыть",img:bx_window_open_default.a},content:0===recordedWork.length||isLoadingEmployees?isLoading||isLoadingEmployees?Object(jsx_runtime.jsx)(PlaceholderLoading.a,{minHeight:"2rem",wrapperClassName:"work-list-widget__list work-list-widget__list--placeholder",itemClassName:"work-list-widget__item"}):Object(jsx_runtime.jsx)("div",{className:"work-list-widget__info",children:"Нет записей о проведенной работе!"}):Object(jsx_runtime.jsx)(WorkListWidget_WorkList,{workshops:workshopsList,employees:employees,employeesMap:employeesMap,userContext:userContext,date:new Date((new Date).setDate((new Date).getDate()-1))})})};WorkListWidget_WorkListWidget_WorkListWidget.displayName="WorkListWidget",WorkListWidget_WorkListWidget_WorkListWidget.__docgenInfo={description:"",methods:[],displayName:"WorkListWidget"};__webpack_exports__.default=Object(react_router.j)(WorkListWidget_WorkListWidget_WorkListWidget);"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MainPage/GeneralPage/WorkManagement/WorkListWidget/WorkListWidget.jsx"]={name:"WorkListWidget",docgenInfo:WorkListWidget_WorkListWidget_WorkListWidget.__docgenInfo,path:"src/components/MainPage/GeneralPage/WorkManagement/WorkListWidget/WorkListWidget.jsx"})}}]);
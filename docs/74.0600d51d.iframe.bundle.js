(window.webpackJsonp=window.webpackJsonp||[]).push([[74],{2844:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",(function(){return workshops})),__webpack_require__.d(__webpack_exports__,"b",(function(){return requestStatuses})),__webpack_require__.d(__webpack_exports__,"a",(function(){return productsStatuses}));var workshops={requests:{name:"Заявки",title:"",redirectURL:"/requests",type:"requests",fullName:"Заявки"},lemz:{name:"ЛЭМЗ",title:"ЛЭМЗ",redirectURL:"/lemz/workshop-lemz",ordersRedirectURL:"/lemz/workshop-orders",storageRedirectURL:"/lemz/workshop-storage",type:"lemz",fullName:"ЦехЛЭМЗ"},lepsari:{name:"Лепсари",title:"Лепсари",redirectURL:"/lepsari/workshop-lepsari",ordersRedirectURL:"/lepsari/workshop-orders",storageRedirectURL:"/lepsari/workshop-storage",type:"lepsari",fullName:"ЦехЛепсари"},ligovskiy:{name:"Лиговский",title:"Лиговский",redirectURL:"/ligovskiy/workshop",ordersRedirectURL:"/ligovskiy/workshop-orders",storageRedirectURL:"/ligovskiy/workshop-storage",type:"ligovskiy",fullName:"ЦехЛиговский"},null:{name:"Заявки",title:"",redirectURL:"/requests",type:"requests",fullName:"Заявки"}},requestStatuses=[{name:"Проблема/Материалы",oldName:"Проблема-материалы",className:"materials",access:["ROLE_ADMIN","ROLE_WORKSHOP"],visible:!1},{name:"Завершено",className:"completed",access:["ROLE_ADMIN"]},{name:"Отгружено",className:"shipped",access:["ROLE_ADMIN","ROLE_WORKSHOP","ROLE_MANAGER"]},{name:"Частично отгружено",className:"shipped-in-parts",access:[]},{name:"Готово к отгрузке",oldName:"Готово",className:"ready",access:["ROLE_ADMIN","ROLE_WORKSHOP"]},{name:"В производстве",className:"in-production",access:[]},{name:"Ожидание",className:"waiting",access:["ROLE_ADMIN","ROLE_MANAGER","ROLE_WORKSHOP"]},{name:"Приоритет",className:"priority",access:["ROLE_ADMIN"]}],productsStatuses=[{name:"В работе",oldName:null,className:"production",access:["ROLE_ADMIN","ROLE_WORKSHOP","ROLE_MANAGER"]},{name:"Завершено",className:"completed",access:["ROLE_ADMIN"]},{name:"Приоритет",className:"defect",access:["ROLE_ADMIN"]}]},2948:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",(function(){return getStorage})),__webpack_require__.d(__webpack_exports__,"d",(function(){return getStorageById})),__webpack_require__.d(__webpack_exports__,"b",(function(){return deleteStorage})),__webpack_require__.d(__webpack_exports__,"a",(function(){return createStorage})),__webpack_require__.d(__webpack_exports__,"e",(function(){return updateStorage}));__webpack_require__(35);var _utilsAPI_jsx__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(10),axios__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(256),axios__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(axios__WEBPACK_IMPORTED_MODULE_2__);function getStorage(workshop){var headers=Object(_utilsAPI_jsx__WEBPACK_IMPORTED_MODULE_1__.a)();return axios__WEBPACK_IMPORTED_MODULE_2___default.a.get("".concat(Object({NODE_ENV:"production",NODE_PATH:[],STORYBOOK:"true",PUBLIC_URL:"."}).API_BASE_URL,"/api/v1/").concat(workshop,"_storage/"),headers)}function getStorageById(workshop,id){var headers=Object(_utilsAPI_jsx__WEBPACK_IMPORTED_MODULE_1__.a)();return axios__WEBPACK_IMPORTED_MODULE_2___default.a.get("".concat(Object({NODE_ENV:"production",NODE_PATH:[],STORYBOOK:"true",PUBLIC_URL:"."}).API_BASE_URL,"/api/v1/").concat(workshop,"_storage/").concat(id),headers)}function deleteStorage(workshop,id){var headers=Object(_utilsAPI_jsx__WEBPACK_IMPORTED_MODULE_1__.a)();return axios__WEBPACK_IMPORTED_MODULE_2___default.a.delete("".concat(Object({NODE_ENV:"production",NODE_PATH:[],STORYBOOK:"true",PUBLIC_URL:"."}).API_BASE_URL,"/api/v1/").concat(workshop,"_storage/").concat(id),headers)}function createStorage(workshop,data){var headers=Object(_utilsAPI_jsx__WEBPACK_IMPORTED_MODULE_1__.a)();return axios__WEBPACK_IMPORTED_MODULE_2___default.a.post("".concat(Object({NODE_ENV:"production",NODE_PATH:[],STORYBOOK:"true",PUBLIC_URL:"."}).API_BASE_URL,"/api/v1/").concat(workshop,"_storage/"),data,headers)}function updateStorage(workshop,data,id){var headers=Object(_utilsAPI_jsx__WEBPACK_IMPORTED_MODULE_1__.a)();return axios__WEBPACK_IMPORTED_MODULE_2___default.a.put("".concat(Object({NODE_ENV:"production",NODE_PATH:[],STORYBOOK:"true",PUBLIC_URL:"."}).API_BASE_URL,"/api/v1/").concat(workshop,"_storage/").concat(id),data,headers)}},3452:function(module,exports,__webpack_require__){var api=__webpack_require__(44),content=__webpack_require__(3453);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},3453:function(module,exports,__webpack_require__){(exports=__webpack_require__(45)(!1)).push([module.i,":root{--accent-color--light: #f8f1f1;--accent-color--contrast: #16c79a;--main-color: #4293b6;--main-color--dark: #19456b}.storage .control-panel{margin-top:-10px;border-top:1px solid #dddddd}\n",""]),module.exports=exports},3598:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var slicedToArray=__webpack_require__(7),slicedToArray_default=__webpack_require__.n(slicedToArray),react=(__webpack_require__(255),__webpack_require__(660),__webpack_require__(661),__webpack_require__(80),__webpack_require__(466),__webpack_require__(198),__webpack_require__(162),__webpack_require__(0)),functions=(__webpack_require__(3452),__webpack_require__(1762),__webpack_require__(470),__webpack_require__(35),__webpack_require__(61)),Table=__webpack_require__(349),jsx_runtime=__webpack_require__(1),TableView_TableView=function TableView(_ref){var data=_ref.data,deleteItem=_ref.deleteItem,userHasAccess=_ref.userHasAccess,link=_ref.link,isLoading=_ref.isLoading,columns=[{text:"Номер",value:"number"},{text:"Название",value:"name"},{text:"Кол-во",value:"quantity",formatFn:function formatFn(_ref2){var quantity=_ref2.quantity;return Object(functions.a)(quantity)}},{text:"Комментарий",value:"comment"}];return Object(jsx_runtime.jsx)(Table.a,{data:data,columns:columns,actions:function actions(_ref3){var id=_ref3.id;return[{elementType:"edit",title:"Редактировать запись",link:"".concat(link,"/edit/").concat(id)},{elementType:"delete",title:"Удаление записи",onClick:function onClick(){return deleteItem(id)},isRendered:userHasAccess(["ROLE_ADMIN"])}]},loading:{isLoading:isLoading}})};TableView_TableView.displayName="TableView",TableView_TableView.__docgenInfo={description:"",methods:[],displayName:"TableView"};var Storage_TableView=TableView_TableView;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MainPage/WorkshopsComponents/Storage/TableView.jsx"]={name:"TableView",docgenInfo:TableView_TableView.__docgenInfo,path:"src/components/MainPage/WorkshopsComponents/Storage/TableView.jsx"});var SearchBar=__webpack_require__(348),Workshop_storage=__webpack_require__(2948),FloatingButton=__webpack_require__(664),ControlPanel=__webpack_require__(663),App=__webpack_require__(132),workshopVariables=__webpack_require__(2844),sorting=__webpack_require__(298),Storage_Storage_Storage=function Storage(props){var userContext=Object(react.useContext)(App.a),_useState=Object(react.useState)([]),_useState2=slicedToArray_default()(_useState,2),storage=_useState2[0],setStorage=_useState2[1],_useState3=Object(react.useState)(""),_useState4=slicedToArray_default()(_useState3,2),searchQuery=_useState4[0],setSearchQuery=_useState4[1],_useState5=Object(react.useState)(!1),_useState6=slicedToArray_default()(_useState5,2),isLoading=_useState6[0],setIsLoading=_useState6[1];Object(react.useEffect)((function(){document.title="Склад",loadStorage()}),[]);var loadStorage=function loadStorage(){setIsLoading(!0),Object(Workshop_storage.c)(props.type).then((function(_ref){var data=_ref.data;setStorage(data),setIsLoading(!1)})).catch((function(error){setIsLoading(!1),console.log(error)}))};return Object(jsx_runtime.jsx)("div",{className:"storage",children:Object(jsx_runtime.jsxs)("div",{className:"main-window",children:[Object(jsx_runtime.jsx)(FloatingButton.a,{linkTo:"".concat(workshopVariables.c[props.type].storageRedirectURL,"/new"),visibility:["ROLE_ADMIN","ROLE_WORKSHOP"]}),Object(jsx_runtime.jsx)(SearchBar.a,{fullSize:!0,placeholder:"Введите артикул детали для поиска...",setSearchQuery:setSearchQuery}),Object(jsx_runtime.jsx)(ControlPanel.a,{itemsCount:"Всего: ".concat(storage.length," записей")}),Object(jsx_runtime.jsx)(Storage_TableView,{data:function sortParts(data){return Object(sorting.a)(function filterData(data){var query=searchQuery.toLowerCase();return data.filter((function(item){return item.id.toString().includes(query)||item.name.toLowerCase().includes(query)||item.quantity.toLowerCase().includes(query)||item.comment.toLowerCase().includes(query)||item.number.toString().toLowerCase().includes(query)}))}(data),{fieldName:"id",direction:"desc"})}(storage),userHasAccess:userContext.userHasAccess,deleteItem:function deleteItem(id){Object(Workshop_storage.b)(props.type,id).then((function(){return loadStorage()}))},isLoading:isLoading,link:workshopVariables.c[props.type].storageRedirectURL})]})})};Storage_Storage_Storage.displayName="Storage",Storage_Storage_Storage.__docgenInfo={description:"",methods:[],displayName:"Storage"};__webpack_exports__.default=Storage_Storage_Storage;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MainPage/WorkshopsComponents/Storage/Storage.jsx"]={name:"Storage",docgenInfo:Storage_Storage_Storage.__docgenInfo,path:"src/components/MainPage/WorkshopsComponents/Storage/Storage.jsx"})}}]);
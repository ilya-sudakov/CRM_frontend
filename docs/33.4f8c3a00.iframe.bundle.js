(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{2835:function(module,__webpack_exports__,__webpack_require__){"use strict";var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(15),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__),react_datepicker__WEBPACK_IMPORTED_MODULE_4__=(__webpack_require__(26),__webpack_require__(159),__webpack_require__(196),__webpack_require__(2863)),react_datepicker__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(react_datepicker__WEBPACK_IMPORTED_MODULE_4__),prop_types__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(2),prop_types__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_5__),date_fns_locale_ru__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(2864),date_fns_locale_ru__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(date_fns_locale_ru__WEBPACK_IMPORTED_MODULE_6__),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__=(__webpack_require__(2862),__webpack_require__(2842),__webpack_require__(1)),InputDate=function InputDate(props){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)("div",{className:"input_date",children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)("div",{className:"input_date__input",children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("div",{className:"input_date__input_name",children:props.inputName+(props.required?"*":"")}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("div",{className:!0===props.error?"input_date__input_field input_date__input_field--error":"input_date__input_field",children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(react_datepicker__WEBPACK_IMPORTED_MODULE_4___default.a,Object.assign({},props,{onChange:props.handleDateChange,disabledKeyboardNavigation:!0,dateFormat:props.showMonthYearPicker?"MM.yyyy":"dd.MM.yyyy",locale:date_fns_locale_ru__WEBPACK_IMPORTED_MODULE_6___default.a}))})]}),!0===props.error&&Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("div",{className:"input_date__error",onClick:props.setErrorsArr?function(){return props.setErrorsArr(Object.assign({},props.errorsArr,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()({},props.name,!1)))}:null,children:"Поле не заполнено!"})]})};InputDate.displayName="InputDate",InputDate.__docgenInfo={description:"",methods:[],displayName:"InputDate",props:{inputName:{type:{name:"string"},required:!1,description:""},required:{type:{name:"bool"},required:!1,description:""},error:{type:{name:"bool"},required:!1,description:""},type:{type:{name:"string"},required:!1,description:""},name:{type:{name:"string"},required:!1,description:""},handleDateChange:{type:{name:"func"},required:!1,description:""},selected:{type:{name:"instanceOf",value:"Date"},required:!1,description:""},readOnly:{type:{name:"bool"},required:!1,description:""},showMonthYearPicker:{type:{name:"bool"},required:!1,description:""},setErrorsArr:{type:{name:"func"},required:!1,description:""},errorsArr:{type:{name:"object"},required:!1,description:""}}},__webpack_exports__.a=InputDate,InputDate.propTypes={inputName:prop_types__WEBPACK_IMPORTED_MODULE_5___default.a.string,required:prop_types__WEBPACK_IMPORTED_MODULE_5___default.a.bool,error:prop_types__WEBPACK_IMPORTED_MODULE_5___default.a.bool,type:prop_types__WEBPACK_IMPORTED_MODULE_5___default.a.string,name:prop_types__WEBPACK_IMPORTED_MODULE_5___default.a.string,handleDateChange:prop_types__WEBPACK_IMPORTED_MODULE_5___default.a.func,selected:prop_types__WEBPACK_IMPORTED_MODULE_5___default.a.instanceOf(Date),readOnly:prop_types__WEBPACK_IMPORTED_MODULE_5___default.a.bool,showMonthYearPicker:prop_types__WEBPACK_IMPORTED_MODULE_5___default.a.bool,setErrorsArr:prop_types__WEBPACK_IMPORTED_MODULE_5___default.a.func,errorsArr:prop_types__WEBPACK_IMPORTED_MODULE_5___default.a.object},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/utils/Form/InputDate/InputDate.jsx"]={name:"InputDate",docgenInfo:InputDate.__docgenInfo,path:"src/utils/Form/InputDate/InputDate.jsx"})},2842:function(module,exports,__webpack_require__){var api=__webpack_require__(48),content=__webpack_require__(2843);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},2843:function(module,exports,__webpack_require__){(exports=__webpack_require__(49)(!1)).push([module.i,':root{--accent-color--light: #f8f1f1;--accent-color--contrast: #16c79a;--main-color: #4293b6;--main-color--dark: #19456b}.input_date{width:calc(100% - 20px);display:flex;flex-direction:column;margin-bottom:20px}.input_date .input_date__error{width:100%;box-sizing:border-box;margin-top:1px;font-size:0.75rem;border:1px solid #d48282;background-color:#fadada;color:#ad1c1c;border-radius:3px;padding:5px 10px;transition:0.2s ease-in-out;cursor:pointer}.input_date .input_date__input{display:flex;flex-direction:column;align-items:flex-start;justify-content:space-between;width:100%}.input_date .input_date__input .input_date__input_name{color:#666;flex:0 1 calc(20% - 10px);padding-right:10px;width:100%;margin-bottom:5px}.input_date .input_date__input .input_date__input_field{display:flex;justify-content:center;width:calc(90% - 20px);position:relative;width:100%}.input_date .input_date__input .input_date__input_field .react-datepicker-wrapper{width:100%}.input_date .input_date__input .input_date__input_field .react-datepicker-wrapper .react-datepicker{z-index:999}.input_date .input_date__input .input_date__input_field .react-datepicker-wrapper .react-datepicker .react-datepicker__day--selected{background-color:#4293b6 !important}.input_date .input_date__input .input_date__input_field .react-datepicker-popper{z-index:999}.input_date .input_date__input .input_date__input_field input[type="text"],.input_date .input_date__input .input_date__input_field input[type="password"]{border:1px solid #bbbbbb;width:100%;padding:5px 10px;border-radius:3px;box-sizing:border-box;transition:100ms ease-in-out;min-height:2rem}.input_date .input_date__input .input_date__input_field input[type="text"]:hover,.input_date .input_date__input .input_date__input_field input[type="password"]:hover{border-color:#888888}.input_date .input_date__input .input_date__input_field input[type="text"]:focus,.input_date .input_date__input .input_date__input_field input[type="password"]:focus{border:1px solid #4293b6}.input_date .input_date__input .input_date__input_field--error input[type="text"],.input_date .input_date__input .input_date__input_field--error input[type="password"]{border:1px solid #d48282 !important}.input_date .input_date__input .input_date__input_field:focus{border:1px solid #4293b6}@media (max-width: 768px){.input_date .input_date__input{flex-wrap:wrap;flex-direction:column;align-items:flex-start}.input_date .input_date__input .input_date__input_name{width:100%;margin-bottom:5px}.input_date .input_date__input .input_date__input_field{width:100%}.input_date .input_date__input .input_date__input_field input{padding:10px !important}}\n',""]),module.exports=exports},2893:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return saveExcelFile})),__webpack_require__.d(__webpack_exports__,"a",(function(){return exportClientsEmailsCSV}));var _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(36),_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(20),_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1__),xlsx__WEBPACK_IMPORTED_MODULE_35__=(__webpack_require__(130),__webpack_require__(79),__webpack_require__(2942),__webpack_require__(2894),__webpack_require__(2895),__webpack_require__(2896),__webpack_require__(2897),__webpack_require__(2898),__webpack_require__(2899),__webpack_require__(2900),__webpack_require__(2901),__webpack_require__(2902),__webpack_require__(2903),__webpack_require__(2904),__webpack_require__(2905),__webpack_require__(2906),__webpack_require__(2907),__webpack_require__(2908),__webpack_require__(2909),__webpack_require__(2910),__webpack_require__(2911),__webpack_require__(2912),__webpack_require__(2913),__webpack_require__(2914),__webpack_require__(2915),__webpack_require__(2916),__webpack_require__(2917),__webpack_require__(2918),__webpack_require__(149),__webpack_require__(50),__webpack_require__(159),__webpack_require__(160),__webpack_require__(198),__webpack_require__(2919)),xlsx__WEBPACK_IMPORTED_MODULE_35___default=__webpack_require__.n(xlsx__WEBPACK_IMPORTED_MODULE_35__),file_saver__WEBPACK_IMPORTED_MODULE_36__=__webpack_require__(2945),file_saver__WEBPACK_IMPORTED_MODULE_36___default=__webpack_require__.n(file_saver__WEBPACK_IMPORTED_MODULE_36__),_sorting_sorting_js__WEBPACK_IMPORTED_MODULE_37__=__webpack_require__(297),saveExcelFile=function(){var _ref=_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_0___default()(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.mark((function _callee(workBook,fileName){var buffer;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default.a.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,workBook.xlsx.writeBuffer();case 2:buffer=_context.sent,file_saver__WEBPACK_IMPORTED_MODULE_36___default.a.saveAs(new Blob([buffer]),"".concat(fileName,".xlsx"));case 4:case"end":return _context.stop()}}),_callee)})));return function saveExcelFile(_x,_x2){return _ref.apply(this,arguments)}}();function s2ab(s){for(var buf=new ArrayBuffer(s.length),view=new Uint8Array(buf),i=0;i!=s.length;++i)view[i]=255&s.charCodeAt(i);return buf}var clientColWidths=[{width:30},{width:20},{width:30},{width:40}],exportClientsEmailsCSV=function exportClientsEmailsCSV(clients){Promise.all(Object(_sorting_sorting_js__WEBPACK_IMPORTED_MODULE_37__.a)(clients,{fieldName:"name",direction:"asc"}).map((function(client){return function addClientContacts(dataWS,client,index){client.contacts.map((function(contactData){var clientRow=[[client.name,client.site,contactData.name,contactData.email]];dataWS=0===index?xlsx__WEBPACK_IMPORTED_MODULE_35___default.a.utils.aoa_to_sheet(clientRow):xlsx__WEBPACK_IMPORTED_MODULE_35___default.a.utils.sheet_add_aoa(dataWS,clientRow,{origin:"A"+index}),index++}))}(null,client,0)}))).then((function(){null["!cols"]=clientColWidths;var wb=xlsx__WEBPACK_IMPORTED_MODULE_35___default.a.utils.book_new();xlsx__WEBPACK_IMPORTED_MODULE_35___default.a.utils.book_append_sheet(wb,null,"Почты"),function saveEmailsCSV(wb,fileName){var wboutput=xlsx__WEBPACK_IMPORTED_MODULE_35___default.a.write(wb,{bookType:"xlsx",bookSST:!1,type:"binary"});file_saver__WEBPACK_IMPORTED_MODULE_36___default.a.saveAs(new Blob([s2ab(wboutput)],{type:""}),fileName)}(wb,"ЭлПочты_SendPulse.xlsx")}))}},2942:function(module,exports,__webpack_require__){"use strict";var $=__webpack_require__(21),global=__webpack_require__(31),arrayBufferModule=__webpack_require__(2963),setSpecies=__webpack_require__(1763),ArrayBuffer=arrayBufferModule.ArrayBuffer;$({global:!0,forced:global.ArrayBuffer!==ArrayBuffer},{ArrayBuffer:ArrayBuffer}),setSpecies("ArrayBuffer")},2945:function(module,exports,__webpack_require__){(function(global){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[],void 0===(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof(__WEBPACK_AMD_DEFINE_FACTORY__=function(){"use strict";function c(a,b,c){var d=new XMLHttpRequest;d.open("GET",a),d.responseType="blob",d.onload=function(){g(d.response,b,c)},d.onerror=function(){console.error("could not download file")},d.send()}function d(a){var b=new XMLHttpRequest;b.open("HEAD",a,!1);try{b.send()}catch(a){}return 200<=b.status&&299>=b.status}function e(a){try{a.dispatchEvent(new MouseEvent("click"))}catch(c){var b=document.createEvent("MouseEvents");b.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),a.dispatchEvent(b)}}var f="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,a=f.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),g=f.saveAs||("object"!=typeof window||window!==f?function(){}:"download"in HTMLAnchorElement.prototype&&!a?function(b,g,h){var i=f.URL||f.webkitURL,j=document.createElement("a");g=g||b.name||"download",j.download=g,j.rel="noopener","string"==typeof b?(j.href=b,j.origin===location.origin?e(j):d(j.href)?c(b,g,h):e(j,j.target="_blank")):(j.href=i.createObjectURL(b),setTimeout((function(){i.revokeObjectURL(j.href)}),4e4),setTimeout((function(){e(j)}),0))}:"msSaveOrOpenBlob"in navigator?function(f,g,h){if(g=g||f.name||"download","string"!=typeof f)navigator.msSaveOrOpenBlob(function b(a,b){return void 0===b?b={autoBom:!1}:"object"!=typeof b&&(console.warn("Deprecated: Expected third argument to be a object"),b={autoBom:!b}),b.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\ufeff",a],{type:a.type}):a}(f,h),g);else if(d(f))c(f,g,h);else{var i=document.createElement("a");i.href=f,i.target="_blank",setTimeout((function(){e(i)}))}}:function(b,d,e,g){if((g=g||open("","_blank"))&&(g.document.title=g.document.body.innerText="downloading..."),"string"==typeof b)return c(b,d,e);var h="application/octet-stream"===b.type,i=/constructor/i.test(f.HTMLElement)||f.safari,j=/CriOS\/[\d]+/.test(navigator.userAgent);if((j||h&&i||a)&&"undefined"!=typeof FileReader){var k=new FileReader;k.onloadend=function(){var a=k.result;a=j?a:a.replace(/^data:[^;]*;/,"data:attachment/file;"),g?g.location.href=a:location=a,g=null},k.readAsDataURL(b)}else{var l=f.URL||f.webkitURL,m=l.createObjectURL(b);g?g.location=m:location.href=m,g=null,setTimeout((function(){l.revokeObjectURL(m)}),4e4)}});f.saveAs=g.saveAs=g,module.exports=g})?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__)||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}).call(this,__webpack_require__(24))},3389:function(module,exports,__webpack_require__){var api=__webpack_require__(48),content=__webpack_require__(3390);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},3390:function(module,exports,__webpack_require__){(exports=__webpack_require__(49)(!1)).push([module.i,":root{--accent-color--light: #f8f1f1;--accent-color--contrast: #16c79a;--main-color: #4293b6;--main-color--dark: #19456b}.clients .main-window__header .main-window__title{margin-bottom:10px !important;display:flex;flex-direction:row;justify-content:flex-start;align-items:center}.clients .main-window__header .main-window__title .main-window__button{font-size:60%;margin-left:15px}.clients .main-window__header .main-window__menu .main-window__item div{position:relative}.clients .main-window__header .main-window__menu .main-window__item div .main-window__menu-item-amount{margin-left:5px;color:#aaaaaa}.clients .main-window__list{position:relative}.clients .main-window__list .main-window__list-item span{align-items:center}.clients .main-window__list .main-window__list-item span:nth-child(1){flex:0 1 15%}.clients .main-window__list .main-window__list-item span:nth-child(2){flex:0 1 10%;max-width:120px;overflow:hidden;text-overflow:ellipsis}.clients .main-window__list .main-window__list-item span:nth-child(3){flex:0 1 15%}.clients .main-window__list .main-window__list-item span:nth-child(4){flex:0 1 30%}.clients .main-window__list .main-window__list-item span:nth-child(5){flex:0 1 10%;max-width:110px}.clients .main-window__list .main-window__list-item .main-window__actions{max-width:125px}.clients .main-window__list-item span:nth-child(3){display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden}.clients .main-window__list-item span:nth-child(4){display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden}.clients .main-window__pagination .main-window__sort-panel{justify-content:center;width:fit-content;margin-right:auto;align-items:center;margin-bottom:0}.clients .main-window__pagination .main-window__sort-panel span{margin-top:0}.clients .main-window__pagination .main-window__sort-panel select{min-width:50px}.clients .main-window__actions{flex-direction:row !important;flex:0 1 20% !important;flex-wrap:wrap}.clients .main-window__actions .main-window__action .main-window__img{width:22px}.clients .main-window__actions .main-window__action:last-child{margin-right:0px}@media (max-width: 768px){.clients .main-window__header .main-window__title{flex-wrap:wrap;margin-bottom:5px !important}.clients .main-window__header .main-window__title span{margin-right:10px}.clients .main-window__header .main-window__title .main-window__button{width:fit-content;margin-top:5px;margin-left:0}.clients .main-window__header .main-window__title .main-window__button span{margin-top:0;margin-right:0}.clients .main-window__header .main-window__menu{overflow-x:auto}.clients .main-window__header .main-window__menu .main-window__item{white-space:nowrap}.clients .main-window__list-item span{max-width:100% !important}.clients .searchbar{width:calc(100% - 10px)}.clients .main-window__pagination .main-window__sort-panel{width:100%}.clients .main-window__pagination .main-window__sort-panel span{display:flex}}@media (max-width: 425px){.clients__reminder{padding:0}.clients__reminder div:first-child{font-size:22px}}\n",""]),module.exports=exports},3391:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/star.d2b59c1f.svg"},3392:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/star_border.08ec7386.svg"},3393:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/phone.921fbea4.svg"},3394:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/calendar.53ee3a73.svg"},3395:function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"static/media/eye-invisible-outlined.4d350da8.svg"},3585:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var toConsumableArray=__webpack_require__(18),toConsumableArray_default=__webpack_require__.n(toConsumableArray),asyncToGenerator=__webpack_require__(36),asyncToGenerator_default=__webpack_require__.n(asyncToGenerator),slicedToArray=__webpack_require__(7),slicedToArray_default=__webpack_require__.n(slicedToArray),regenerator=__webpack_require__(20),regenerator_default=__webpack_require__.n(regenerator),react=(__webpack_require__(130),__webpack_require__(79),__webpack_require__(1005),__webpack_require__(160),__webpack_require__(149),__webpack_require__(198),__webpack_require__(50),__webpack_require__(461),__webpack_require__(26),__webpack_require__(460),__webpack_require__(296),__webpack_require__(35),__webpack_require__(467),__webpack_require__(656),__webpack_require__(657),__webpack_require__(159),__webpack_require__(0)),API_Clients=(__webpack_require__(3389),__webpack_require__(1758),__webpack_require__(2830),__webpack_require__(2849)),react_router_dom=__webpack_require__(44),FormWindow=__webpack_require__(199),FloatingPlus=__webpack_require__(661),ControlPanel=__webpack_require__(2827),SelectWorkHistory=__webpack_require__(2964),Button=__webpack_require__(197),jsx_runtime=__webpack_require__(1),EditWorkHistory_EditWorkHistory=function EditWorkHistory(props){var _useState=Object(react.useState)(!1),_useState2=slicedToArray_default()(_useState,2),isLoading=_useState2[0],setIsLoading=_useState2[1],_useState3=Object(react.useState)([]),_useState4=slicedToArray_default()(_useState3,2),workHistory=_useState4[0],setWorkHistory=_useState4[1],_useState5=Object(react.useState)([]),_useState6=slicedToArray_default()(_useState5,2),workHistoryNew=_useState6[0],setWorkHistoryNew=_useState6[1],_useState7=Object(react.useState)(0),_useState8=slicedToArray_default()(_useState7,2),clientId=_useState8[0],setClientId=_useState8[1];return Object(react.useEffect)((function(){props.selectedItem&&props.setShowWindow&&!0===props.closeWindow?props.setShowWindow(!1):(setClientId(props.selectedItem.id),setWorkHistory(props.selectedItem.histories),setWorkHistoryNew(props.selectedItem.histories))}),[props.selectedItem,props.closeWindow]),Object(jsx_runtime.jsxs)("div",{className:"main-form",children:[Object(jsx_runtime.jsx)("div",{className:"main-form__title",children:"История работы"}),Object(jsx_runtime.jsxs)("form",{className:"main-form__form",children:[Object(jsx_runtime.jsx)("div",{className:"main-form__item",children:Object(jsx_runtime.jsx)(SelectWorkHistory.a,{defaultValue:workHistory,userHasAccess:props.userHasAccess,handleWorkHistoryChange:function handleWorkHistoryChange(value){setWorkHistoryNew(value)}})}),Object(jsx_runtime.jsxs)("div",{className:"main-form__buttons main-form__buttons--full",children:[Object(jsx_runtime.jsx)("input",{className:"main-form__submit main-form__submit--inverted",type:"submit",onClick:function onClick(){props.setCloseWindow(!props.closeWindow)},value:"Закрыть"}),Object(jsx_runtime.jsx)(Button.a,{text:"Сохранить",isLoading:isLoading,className:"main-form__submit",onClick:function handleSubmit(){setIsLoading(!0);var itemsArr=workHistoryNew.map((function(selected){var edited=!1,editedItem=null;if(workHistory.map((function(item){if(item.id===selected.id)return edited=!0,void(editedItem=item)})),selected!==editedItem)return!0===edited?props.editWorkHistory({date:selected.date,action:selected.action,result:selected.result,comment:selected.comment,clientId:clientId},selected.id):props.addWorkHistory({date:selected.date,action:selected.action,result:selected.result,comment:selected.comment,clientId:clientId})}));Promise.all(itemsArr).then((function(){var itemsArr=workHistory.map((function(item){var deleted=!0;return workHistoryNew.map((function(selected){selected.id!==item.id||(deleted=!1)})),!0===deleted&&props.deleteWorkHistory(item.id)}));Promise.all(itemsArr).then((function(){setIsLoading(!1),props.setCloseWindow(!props.closeWindow)}))}))}})]})]})]})};EditWorkHistory_EditWorkHistory.displayName="EditWorkHistory",EditWorkHistory_EditWorkHistory.__docgenInfo={description:"",methods:[],displayName:"EditWorkHistory"};var MainComponents_EditWorkHistory=EditWorkHistory_EditWorkHistory;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MainPage/Clients/MainComponents/EditWorkHistory.jsx"]={name:"EditWorkHistory",docgenInfo:EditWorkHistory_EditWorkHistory.__docgenInfo,path:"src/components/MainPage/Clients/MainComponents/EditWorkHistory.jsx"});__webpack_require__(196);var InputDate=__webpack_require__(2835),EditContactDay_EditNextContactDate=function EditNextContactDate(props){var _useState=Object(react.useState)(new Date),_useState2=slicedToArray_default()(_useState,2),date=_useState2[0],setDate=_useState2[1],_useState3=Object(react.useState)(!1),_useState4=slicedToArray_default()(_useState3,2),isLoading=_useState4[0],setIsLoading=_useState4[1];return Object(react.useEffect)((function(){props.selectedItem.nextDateContact&&props.setShowWindow&&!0===props.closeWindow?props.setShowWindow(!1):setDate(props.selectedItem.nextDateContact)}),[props.selectedItem,props.closeWindow]),Object(jsx_runtime.jsxs)("div",{className:"main-form",children:[Object(jsx_runtime.jsx)("div",{className:"main-form__title",children:"Редактирование даты"}),Object(jsx_runtime.jsxs)("form",{className:"main-form__form",children:[Object(jsx_runtime.jsx)(InputDate.a,{inputName:"Дата след. контакта",name:"nextContactDate",selected:Date.parse(date),handleDateChange:function handleDateChange(value){setDate(value)}}),Object(jsx_runtime.jsxs)("div",{className:"main-form__buttons main-form__buttons--full",children:[Object(jsx_runtime.jsx)("input",{className:"main-form__submit main-form__submit--inverted",type:"submit",onClick:function onClick(){props.setCloseWindow(!props.closeWindow)},value:"Закрыть"}),Object(jsx_runtime.jsx)(Button.a,{text:"Изменить дату",isLoading:isLoading,className:"main-form__submit",onClick:function handleSubmit(){setIsLoading(!0),props.editNextContactDate({nextDateContact:new Date(date).getTime()/1e3,id:props.selectedItem.id}).then((function(){setIsLoading(!1),props.loadData(props.selectedItem.category.name,"Активные"===props.selectedItem.clientType?"active":"Потенциальные"===props.selectedItem.clientType?"potential":"in-progress"),props.setCloseWindow(!props.closeWindow)}))}})]})]})]})};EditContactDay_EditNextContactDate.displayName="EditNextContactDate",EditContactDay_EditNextContactDate.__docgenInfo={description:"",methods:[],displayName:"EditNextContactDate"};var EditContactDay=EditContactDay_EditNextContactDate;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MainPage/Clients/MainComponents/EditContactDay.jsx"]={name:"EditNextContactDate",docgenInfo:EditContactDay_EditNextContactDate.__docgenInfo,path:"src/components/MainPage/Clients/MainComponents/EditContactDay.jsx"});var star=__webpack_require__(3391),star_default=__webpack_require__.n(star),star_border=__webpack_require__(3392),star_border_default=__webpack_require__.n(star_border),phone=__webpack_require__(3393),phone_default=__webpack_require__.n(phone),calendar=__webpack_require__(3394),calendar_default=__webpack_require__.n(calendar),eye_invisible_outlined=__webpack_require__(3395),eye_invisible_outlined_default=__webpack_require__.n(eye_invisible_outlined),functions=__webpack_require__(61),sortClients=(__webpack_require__(463),__webpack_require__(2893),function sortClients(clients,searchQuery,sortOrder){return clients.sort((function(a,b){if(""!==searchQuery){var first="nextDateContact"===sortOrder.curSort?new Date(a[sortOrder.curSort]):a[sortOrder.curSort],second="nextDateContact"===sortOrder.curSort?new Date(b[sortOrder.curSort]):b[sortOrder.curSort];return first<second?"desc"===sortOrder[sortOrder.curSort]?1:-1:first>second?"desc"===sortOrder[sortOrder.curSort]?-1:1:0}}))}),App=__webpack_require__(131),Table=__webpack_require__(350),ClientsList_ClientsList=function ClientsList(_ref){var isLoading=_ref.isLoading,itemsPerPage=_ref.itemsPerPage,clients=_ref.clients,searchQuery=_ref.searchQuery,sortOrder=_ref.sortOrder,deleteItem=_ref.deleteItem,type=_ref.type,setCloseWindow=_ref.setCloseWindow,setSelectedItem=_ref.setSelectedItem,setShowWindow=_ref.setShowWindow,setCurForm=_ref.setCurForm,editItemFunction=_ref.editItemFunction,setClients=_ref.setClients,userContext=Object(react.useContext)(App.a),columns=[{text:"Название",value:"name",width:"20%"},{text:"Сайт",value:"site",link:{getURL:function getURL(site){var _site$split;return site&&(null==site||null===(_site$split=site.split("//"))||void 0===_site$split?void 0:_site$split.length)>1?site:"https://".concat(site)},isOutside:!0,newTab:!0},width:"15%"},{text:"Контакты",value:"contacts",formatFn:function formatContacts(_ref2){var contacts=_ref2.contacts;return(null==contacts?void 0:contacts.length)>0?(""!==contacts[0].name?"".concat(contacts[0].name,", "):"")+contacts[0].phoneNumber:"Не указаны контакт. данные"},width:"25%"},{text:"Комментарий",value:"comment",width:"30%"},{text:"След. контакт",value:"nextDateContact",formatFn:function formatFn(_ref3){var nextDateContact=_ref3.nextDateContact;return Object(functions.g)(nextDateContact)},width:"10%",badge:{isVisibleFn:function isVisibleFn(date){return new Date(date)<new Date},type:"error"}}];return Object(jsx_runtime.jsx)(Table.a,{columns:columns,data:sortClients(clients,searchQuery,sortOrder),loading:{isLoading:isLoading,itemsPerPage:itemsPerPage},actions:function actionsList(item,index){return[{title:item.favorite?"Убрать из избранных клиентов":"Добавить в избранных клиентов",onClick:function onClick(){return function handleFavouriteClick(item,index,clients){var temp=clients,newClient=Object.assign({type:item.type,categoryId:item.category.id,check:item.check,clientType:item.clientType,comment:item.comment,manager:item.manager,name:item.name,nextDateContact:new Date(item.nextDateContact).getTime()/1e3,price:item.price,site:item.site,storageAddress:item.storageAddress,workCondition:item.workCondition,favorite:!item.favorite});editItemFunction(newClient,item.id).then((function(){temp.splice(index,1,Object.assign({},item,{favorite:!item.favorite})),setClients(toConsumableArray_default()(temp))})).catch((function(error){console.log(error)}))}(item,index,clients)},imgSrc:item.favorite?star_default.a:star_border_default.a,isRendered:userContext.userHasAccess(["ROLE_ADMIN"])},{title:"Скрыть клиента",onClick:function onClick(){return function handleHideClient(item,index,clients){var temp=clients,newClient=Object.assign({type:item.type,categoryId:item.category.id,check:item.check,clientType:item.clientType,comment:item.comment,manager:item.manager,name:item.name,nextDateContact:new Date(item.nextDateContact).getTime()/1e3,price:item.price,site:item.site,storageAddress:item.storageAddress,workCondition:item.workCondition,favorite:!item.favorite,isClosed:!0});editItemFunction(newClient,item.id).then((function(){temp.splice(index,1,Object.assign({},item,{isClosed:!0})),setClients(toConsumableArray_default()(temp)),alert("Клиент успешно скрыт")})).catch((function(error){console.log(error)}))}(item,index,clients)},imgSrc:eye_invisible_outlined_default.a,isRendered:userContext.userHasAccess(["ROLE_ADMIN"])},{title:"Совершить действие",onClick:function onClick(){setCloseWindow(!1),setSelectedItem(item),setShowWindow(!0),setCurForm("workHistory")},imgSrc:phone_default.a},{title:"Дата следующего контакта",onClick:function onClick(){setCloseWindow(!1),setSelectedItem(item),setShowWindow(!0),setCurForm("nextContactDate")},imgSrc:calendar_default.a},{elementType:"edit",title:"Редактирование клиента",link:"/".concat(type,"/edit/").concat(item.id),openInNewTab:!0},{elementType:"delete",title:"Удаление клиента",onClick:function onClick(){return deleteItem(item.id,index)},isRendered:userContext.userHasAccess(["ROLE_ADMIN"])}]}})};ClientsList_ClientsList.displayName="ClientsList",ClientsList_ClientsList.__docgenInfo={description:"",methods:[],displayName:"ClientsList"};var MainComponents_ClientsList=ClientsList_ClientsList;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MainPage/Clients/MainComponents/ClientsList.jsx"]={name:"ClientsList",docgenInfo:ClientsList_ClientsList.__docgenInfo,path:"src/components/MainPage/Clients/MainComponents/ClientsList.jsx"});var LegalEntity=__webpack_require__(2965),Contacts=__webpack_require__(2966),WorkHistory=__webpack_require__(2967),utilsAPI=__webpack_require__(10);var clientTypes={clients:{name:"клиент",title:"Клиенты",type:null,loadItemsByCategory:function loadItemsByCategory(category,curPage,itemsPerPage,sortOrder,signal){return Object(API_Clients.h)(category,curPage,itemsPerPage,sortOrder,signal)},editItemFunction:function editItemFunction(newClient,id){return Object(API_Clients.c)(newClient,id)},deleteItemFunction:function deleteItemFunction(id){return Object(API_Clients.b)(id)},editWorkHistoryFunction:function editWorkHistoryFunction(newWorkHistory,id){return Object(WorkHistory.c)(newWorkHistory,id)},editNextContactDateFunction:function editNextContactDateFunction(date){return Object(API_Clients.d)(date)},addWorkHistoryFunction:function addWorkHistoryFunction(newWorkHistory){return Object(WorkHistory.a)(newWorkHistory)},deleteWorkHistoryFunction:function deleteWorkHistoryFunction(id){return Object(WorkHistory.b)(id)},deleteContactsFunction:function deleteContactsFunction(id){return Object(Contacts.b)(id)},deleteLegalEntityFunction:function deleteLegalEntityFunction(id){return Object(LegalEntity.b)(id)}},suppliers:{name:"поставщик",title:"Поставщики",type:"supplier",loadItemsByCategory:function loadItemsByCategory(category,curPage,itemsPerPage,sortOrder,signal){return function getSuppliersByCategoryAndType(category_type,curPage,itemsPerPage,sortOrder,signal){return Object(utilsAPI.b)({url:Object({NODE_ENV:"production",NODE_PATH:[],STORYBOOK:"true",PUBLIC_URL:"."}).API_BASE_URL+"/api/v1/client/category_type/supplier/?page="+(curPage-1)+"&sort="+sortOrder.curSort+","+sortOrder[sortOrder.curSort]+"&size="+itemsPerPage,method:"POST",body:JSON.stringify(category_type),signal:signal})}(category,curPage,itemsPerPage,sortOrder,signal)},editItemFunction:function editItemFunction(newClient,id){return Object(API_Clients.c)(newClient,id)},deleteItemFunction:function deleteItemFunction(id){return Object(API_Clients.b)(id)},editWorkHistoryFunction:function editWorkHistoryFunction(newWorkHistory,id){return Object(WorkHistory.c)(newWorkHistory,id)},editNextContactDateFunction:function editNextContactDateFunction(date){return Object(API_Clients.d)(date)},addWorkHistoryFunction:function addWorkHistoryFunction(newWorkHistory){return Object(WorkHistory.a)(newWorkHistory)},deleteWorkHistoryFunction:function deleteWorkHistoryFunction(id){return Object(WorkHistory.b)(id)},deleteContactsFunction:function deleteContactsFunction(id){return Object(Contacts.b)(id)},deleteLegalEntityFunction:function deleteLegalEntityFunction(id){return Object(LegalEntity.b)(id)}}},hooks=__webpack_require__(1001),Clients_Clients_Clients=function Clients(props){var _useState=Object(react.useState)([]),_useState2=slicedToArray_default()(_useState,2),clients=_useState2[0],setClients=_useState2[1],_useState3=Object(react.useState)(""),_useState4=slicedToArray_default()(_useState3,2),curCategory=_useState4[0],setCurCategory=_useState4[1],_useState5=Object(react.useState)(""),_useState6=slicedToArray_default()(_useState5,2),curClientType=_useState6[0],setCurClientType=_useState6[1],_usePagination=Object(hooks.c)(""!==curCategory?function(){return loadData(curCategory,curClientType)}:null,[curClientType,curCategory],"dynamic",{sortOrder:{curSort:"name",name:"asc",nextDateContact:"asc"},size:10}),pagination=_usePagination.pagination,curPage=_usePagination.curPage,setCurPage=_usePagination.setCurPage,isLoading=_usePagination.isLoading,itemsPerPage=_usePagination.itemsPerPage,sortOrder=_usePagination.sortOrder,data=_usePagination.data,setSortOrder=_usePagination.setSortOrder,_useState7=Object(react.useState)(!1),_useState8=slicedToArray_default()(_useState7,2),isLoadingClients=_useState8[0],setIsLoadingClients=_useState8[1],_useState9=Object(react.useState)(0),_useState10=slicedToArray_default()(_useState9,2),itemsActiveCount=_useState10[0],setItemsActiveCount=_useState10[1],_useState11=Object(react.useState)(0),_useState12=slicedToArray_default()(_useState11,2),itemsPotentialCount=_useState12[0],setItemsPotentialCount=_useState12[1],_useState13=Object(react.useState)(0),_useState14=slicedToArray_default()(_useState13,2),itemsProgressCount=_useState14[0],setItemsProgressCount=_useState14[1],_useState15=Object(react.useState)("nextContactDate"),_useState16=slicedToArray_default()(_useState15,2),curForm=_useState16[0],setCurForm=_useState16[1],_useState17=Object(react.useState)(!1),_useState18=slicedToArray_default()(_useState17,2),showWindow=_useState18[0],setShowWindow=_useState18[1],_useState19=Object(react.useState)(!1),_useState20=slicedToArray_default()(_useState19,2),closeWindow=_useState20[0],setCloseWindow=_useState20[1],_useState21=Object(react.useState)({}),_useState22=slicedToArray_default()(_useState21,2),selectedItem=_useState22[0],setSelectedItem=_useState22[1],userContext=Object(react.useContext)(App.a),menuItems=[{link:"active",name:"Активные",count:itemsActiveCount},{link:"potential",name:"Потенциальные",count:itemsPotentialCount},{link:"in-progress",name:"В разработке",count:itemsProgressCount}],deleteItem=function(){var _ref=asyncToGenerator_default()(regenerator_default.a.mark((function _callee(clientId,index){var client;return regenerator_default.a.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return client=data.find((function(item){return item.id===clientId})),setIsLoadingClients(!0),_context.abrupt("return",Promise.all(client.legalEntities.map((function(item){return clientTypes[props.type].deleteLegalEntityFunction(item.id)}))).then((function(){return Promise.all(client.contacts.map((function(item){return clientTypes[props.type].deleteContactsFunction(item.id)})))})).then((function(){return Promise.all(client.histories.map((function(item){return clientTypes[props.type].deleteWorkHistoryFunction(item.id)})))})).then((function(){return setIsLoadingClients(!1),clientTypes[props.type].deleteItemFunction(clientId).then((function(){var temp=clients;temp.splice(index,1),setClients(toConsumableArray_default()(temp))}))})).catch((function(error){setIsLoadingClients(!1),alert("Ошибка при удалении"),console.log(error)})));case 3:case"end":return _context.stop()}}),_callee)})));return function deleteItem(_x,_x2){return _ref.apply(this,arguments)}}(),loadData=function loadData(category,type,signal){return setSearchQuery(""),clientTypes[props.type].loadItemsByCategory({categoryName:category,clientType:"active"===type?"Активные":"potential"===type?"Потенциальные":"В разработке"},curPage,itemsPerPage,sortOrder,signal)},_useSearchBar=Object(hooks.e)(void 0,[],(function(query){setIsLoadingClients(!0),""===query?(setIsLoadingClients(!1),loadData(curCategory,curClientType)):Object(API_Clients.j)(Object.assign({name:query,city:query,type:clientTypes[props.type].type},advancedOptions[0].parentCheckbox.value&&{taxes:advancedOptions[0].childCheckbox.value}),[selectedOption,advancedOptions[0].parentCheckbox.value?"taxes":null]).then((function(res){return res.json()})).then((function(res){setClients(res),setIsLoadingClients(!1)})).catch((function(error){console.log(error),setIsLoadingClients(!1)}))}),[{text:"Везде",value:""},{text:"Город",value:"city"}],[{type:"groupCheckbox",parentCheckbox:{text:"Поиск по налогообложению",value:!1},childCheckbox:{text:"УСН",value:!1}}]),searchQuery=_useSearchBar.searchQuery,setSearchQuery=_useSearchBar.setSearchQuery,searchBar=_useSearchBar.searchBar,selectedOption=_useSearchBar.selectedOption,advancedOptions=_useSearchBar.advanced,initialLoad=function initialLoad(){var curCategoryTemp=props.location.pathname.split("/category/")[1].split("/")[0],curClientTypeTemp=props.location.pathname.split("/category/")[1].split("/")[1];""===curCategory||""===curClientTypeTemp||curCategoryTemp===curCategory&&curClientTypeTemp===curClientType||setCurPage(1),setCurCategory(curCategoryTemp),setCurClientType(curClientTypeTemp),function loadClientsTotalByType(category){var clientCategories=[{clientType:"Активные",setter:function setter(count){return setItemsActiveCount(count)}},{clientType:"Потенциальные",setter:function setter(count){return setItemsPotentialCount(count)}},{clientType:"В разработке",setter:function setter(count){return setItemsProgressCount(count)}}];Promise.all(clientCategories.map((function(item){return clientTypes[props.type].loadItemsByCategory({categoryName:category,clientType:item.clientType},1,1,sortOrder).then((function(res){return res.json()})).then((function(res){return item.setter(res.totalElements)}))})))}(curCategoryTemp)};return Object(react.useEffect)((function(){document.title=clientTypes[props.type].title;var abortController=new AbortController;return initialLoad(abortController.signal),function cancel(){abortController.abort()}}),[props.location,props.type]),Object(jsx_runtime.jsx)("div",{className:"clients",children:Object(jsx_runtime.jsxs)("div",{className:"main-window",children:[Object(jsx_runtime.jsx)(FloatingPlus.a,{linkTo:"/"+props.type+"/new",visibility:["ROLE_ADMIN","ROLE_MANAGER"]}),Object(jsx_runtime.jsxs)("div",{className:"main-window__header main-window__header--full",children:[Object(jsx_runtime.jsx)("div",{className:"main-window__title",children:Object(jsx_runtime.jsx)("span",{children:curCategory})}),Object(jsx_runtime.jsx)("div",{className:"main-window__menu",children:menuItems.map((function(menuItem,index){return Object(jsx_runtime.jsx)(Clients_MenuItem,{type:props.type,curCategory:curCategory,location:props.location,item:menuItem},index)}))})]}),searchBar,Object(jsx_runtime.jsx)(FormWindow.a,{title:"nextContactDate"===curForm?"Дата следующего контакта":"Запись действия",content:Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{children:"nextContactDate"===curForm?Object(jsx_runtime.jsx)(EditContactDay,{selectedItem:selectedItem,showWindow:showWindow,setShowWindow:setShowWindow,setCloseWindow:setCloseWindow,closeWindow:closeWindow,loadData:loadData,editNextContactDate:clientTypes[props.type].editNextContactDateFunction}):Object(jsx_runtime.jsx)(MainComponents_EditWorkHistory,{selectedItem:selectedItem,showWindow:showWindow,setShowWindow:setShowWindow,setCloseWindow:setCloseWindow,closeWindow:closeWindow,userHasAccess:userContext.userHasAccess,addWorkHistory:clientTypes[props.type].addWorkHistoryFunction,editWorkHistory:clientTypes[props.type].editWorkHistoryFunction,deleteWorkHistory:clientTypes[props.type].deleteWorkHistoryFunction})}),showWindow:showWindow,setShowWindow:setShowWindow}),Object(jsx_runtime.jsx)(ControlPanel.a,{sorting:Object(jsx_runtime.jsx)("div",{className:"main-window__sort-panel",children:Object(jsx_runtime.jsxs)("select",{onChange:function onChange(event){return setSortOrder(Object(functions.b)(event))},children:[Object(jsx_runtime.jsx)("option",{value:"name asc",children:"По алфавиту (А-Я)"}),Object(jsx_runtime.jsx)("option",{value:"name desc",children:"По алфавиту (Я-А)"}),Object(jsx_runtime.jsx)("option",{value:"nextDateContact asc",children:"По дате след. контакта"})]})})}),Object(jsx_runtime.jsx)(MainComponents_ClientsList,{isLoading:isLoadingClients||isLoading,itemsPerPage:itemsPerPage,clients:""===searchQuery?data:clients,searchQuery:searchQuery,sortOrder:sortOrder,deleteItem:deleteItem,setClients:setClients,type:props.type,userContext:userContext,setCloseWindow:setCloseWindow,setSelectedItem:setSelectedItem,setShowWindow:setShowWindow,setCurForm:setCurForm,editItemFunction:clientTypes[props.type].editItemFunction}),""===searchQuery?pagination:null]})})};Clients_Clients_Clients.displayName="Clients",Clients_Clients_Clients.__docgenInfo={description:"",methods:[],displayName:"Clients"};__webpack_exports__.default=Clients_Clients_Clients;var Clients_MenuItem=function MenuItem(_ref2){var type=_ref2.type,curCategory=_ref2.curCategory,item=_ref2.item,location=_ref2.location;return Object(jsx_runtime.jsx)(react_router_dom.a,{to:"/".concat(type,"/category/").concat(curCategory,"/").concat(item.link),className:!0===location.pathname.includes(item.link)?"main-window__item--active main-window__item":"main-window__item",children:Object(jsx_runtime.jsxs)("div",{children:[item.name,Object(jsx_runtime.jsx)("span",{className:"main-window__menu-item-amount",children:item.count})]})})};Clients_MenuItem.displayName="MenuItem","undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MainPage/Clients/Clients.jsx"]={name:"Clients",docgenInfo:Clients_Clients_Clients.__docgenInfo,path:"src/components/MainPage/Clients/Clients.jsx"})}}]);